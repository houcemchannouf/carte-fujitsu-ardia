_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   1
- ASSEMBLE INFORMATION - ( STARTUP )

|             Command line         :  C:\Softune\BIN\fasm907s.exe -f C:\Doc |
|                                     uments and Settings\ARDIA\Bureau\ARDI |
|                                     A-CEDU01\trunk\ARDIA-CEDU01\06-SW_TES |
|                                     TLIS3DH\B1.0\CONFIGURATION\OPT\CEDU01 |
|                                     _PRJ.opa -Xdof -o C:\Documents and Se |
|                                     ttings\ARDIA\Bureau\ARDIA-CEDU01\trun |
|                                     k\ARDIA-CEDU01\06-SW_TESTLIS3DH\B1.0\ |
|                                     CONFIGURATION\OBJ\start.obj -lf C:\Do |
|                                     cuments and Settings\ARDIA\Bureau\ARD |
|                                     IA-CEDU01\trunk\ARDIA-CEDU01\06-SW_TE |
|                                     STLIS3DH\B1.0\CONFIGURATION\LST\start |
|                                     .lst C:\Documents and Settings\ARDIA\ |
|                                     Bureau\ARDIA-CEDU01\trunk\ARDIA-CEDU0 |
|                                     1\06-SW_TESTLIS3DH\B1.0\SYSTEME\STUP\ |
|                                     start.asm -@Hf C:\Documents and Setti |
|                                     ngs\ARDIA\Bureau\ARDIA-CEDU01\trunk\A |
|                                     RDIA-CEDU01\06-SW_TESTLIS3DH\B1.0\CON |
|                                     FIGURATION\OPT\start.tpi              |
|                                                                           |
|             Total errors         :    0                                   |
|             Total warnings       :    0                                   |
|                                       There were no errors.               |
|                                                                           |
|             Object file          :  C:\Documents and Settings\ARDIA\Burea |
|                                     u\ARDIA-CEDU01\trunk\ARDIA-CEDU01\06- |
|                                     SW_TESTLIS3DH\B1.0\CONFIGURATION\OBJ\ |
|                                     start.obj                             |
|             List file            :  C:\Documents and Settings\ARDIA\Burea |
|                                     u\ARDIA-CEDU01\trunk\ARDIA-CEDU01\06- |
|                                     SW_TESTLIS3DH\B1.0\CONFIGURATION\LST\ |
|                                     start.lst                             |
|                                                                           |
|                                                                           |
| NO NEST     SOURCE-FILE-NAME                     CREATE DATE/TIME         |
| -- -------- ------------------------------------ ------------------------ |
|  0          C:\Documents and Settings\ARDIA\Bure 2012-05-17 16:03:37      |
|             au\ARDIA-CEDU01\trunk\ARDIA-CEDU01\0                          |
|             6-SW_TESTLIS3DH\B1.0\SYSTEME\STUP\st                          |
|             art.asm                                                       |
| -- -------- ------------------------------------ ------------------------ |
|                                                                           |
|                                                                           |
|             Current path         :  C:\Documents and Settings\ARDIA\Burea |
|                                     u\ARDIA-CEDU01\trunk\ARDIA-CEDU01\06- |
|                                     SW_TESTLIS3DH\B1.0\CONFIGURATION      |
|             Include path         :  INC907     = C:\Softune\LIB\907\INCLU |
|                                                  DE\                      |
|             Work file path       :  TMP        = C:\DOCUME~1\ARDIA\LOCALS |
|                                                  ~1\Temp\                 |
|             Default Option file  :  OPT907     = C:\Softune\LIB\907\ (fas |
|                                                  m907.opt)                |
|                                                                           |
|                                                                           |
| NO NEST     OPTION-FILE-NAME                     CREATE DATE/TIME         |
| -- -------- ------------------------------------ ------------------------ |
|  0          C:\Documents and Settings\ARDIA\Bure 2012-05-17 16:24:24      |
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   2
- ASSEMBLE INFORMATION - ( STARTUP )

|             au\ARDIA-CEDU01\trunk\ARDIA-CEDU01\0                          |
|             6-SW_TESTLIS3DH\B1.0\CONFIGURATION\O                          |
|             PT\CEDU01_PRJ.opa                                             |
|             ------------------------------------                          |
|             -g                                                            |
|             -w 2                                                          |
|             -linf ON                                                      |
|             -lsrc ON                                                      |
|             -lsec ON                                                      |
|             -lcros OFF                                                    |
|             -linc ON                                                      |
|             -lexp OBJ                                                     |
|             -pl 60                                                        |
|             -pw 100                                                       |
|             -tab 8                                                        |
|             -cwno                                                         |
|             -cpu MB96F346RSA                                              |
| -- -------- ------------------------------------ ------------------------ |
|___________________________________________________________________________|


_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   3
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

<C:\Documents and Settings\ARDIA\Bureau
\ARDIA-CEDU01\trunk\ARDIA-CEDU01\06-SW_
TESTLIS3DH\B1.0\SYSTEME\STUP\start.asm> =====
                                            1      ;===============================================
                                                   =====================
                                            2      ;
                                            3      ;    Startup file for memory and basic controlle
                                                   r initialisation
                                            4      ;
                                            5      ;    MB96300 Family C Compiler
                                            6      ;
                                            7      ;===============================================
                                                   =====================
                                            8      ; 1  Disclaimer
                                            9      ;===============================================
                                                   =====================
                                           10      ;

                                           11      /***********************************************
                                                   *************************/
                                           12      /*               (C) Fujitsu Microelectronics Eu
                                                   rope GmbH               */
                                           13      /*
                                                                           */
                                           14      /* The following software deliverable is intende
                                                   d for and must only be  */
                                           15      /* used in an evaluation laboratory environment.
                                                                           */
                                           16      /* It is provided without charge and therefore p
                                                   rovided on an as-is     */
                                           17      /* basis, subject to alterations.
                                                                           */
                                           18      /*
                                                                           */
                                           19      /* The software deliverable is to be used exclus
                                                   ively in connection     */
                                           20      /* with FME products.
                                                                           */
                                           21      /* In the event the software deliverable include
                                                   s the use of open       */
                                           22      /* source components, the provisions of the gove
                                                   rning open source       */
                                           23      /* license agreement shall apply with respect to
                                                    such software          */
                                           24      /* deliverable.
                                                                           */
                                           25      /* FME does not warrant that the deliverables do
                                                    not infringe any       */
                                           26      /* third party intellectual property right (IPR)
                                                   . In the event that     */
                                           27      /* the deliverables infringe a third party IPR i
                                                   t is the sole           */
                                           28      /* responsibility of the customer to obtain nece
                                                   ssary licenses to       */
                                           29      /* continue the usage of the deliverable.
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   4
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                                           */
                                           30      /*
                                                                           */
                                           31      /* To the maximum extent permitted by applicable
                                                    law FME disclaims all  */
                                           32      /* warranties, whether express or implied, in pa
                                                   rticular, but not       */
                                           33      /* limited to, warranties of merchantability and
                                                    fitness for a          */
                                           34      /* particular purpose for which the deliverable
                                                   is not designated.      */
                                           35      /*
                                                                           */
                                           36      /* To the maximum extent permitted by applicable
                                                    law, FME’s liability   */
                                           37      /* is restricted to intention and gross negligen
                                                   ce.                     */
                                           38      /* FME is not liable for consequential damages.
                                                                           */
                                           39      /*
                                                                           */
                                           40      /* (V1.2)
                                                                           */
                                           41      /***********************************************
                                                   *************************/
                                           42

                                           43      ;
                                           44      ;===============================================
                                                   =====================
                                           45
MODULE NAME = STARTUP                      46                .PROGRAM  STARTUP
                                           47                .TITLE    "STARTUP FILE FOR MEMORY INI
                                                   TIALISATION"
                                           48
                                           49      ;===============================================
                                                   =====================
                                           50      ; 2  Contents
                                           51      ;===============================================
                                                   =====================
                                           52      ;
                                           53      ; 1  Disclaimer
                                           54      ;
                                           55      ; 2  Contents
                                           56      ;
                                           57      ; 3  History
                                           58      ;
                                           59      ; 4  Settings
                                           60      ; 4.1   Controller Series, Device
                                           61      ; 4.2   C-language Memory model
                                           62      ; 4.3   Function-Call Interface
                                           63      ; 4.4   Constant Data Handling
                                           64      ; 4.5   Stack Type and Stack Size
                                           65      ; 4.6   General Register Bank
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   5
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                           66      ; 4.7   Low-Level Library Interface
                                           67      ; 4.8   Clock Selection
                                           68      ; 4.9   Clock Stabilization Time
                                           69      ; 4.10  External Bus Interface
                                           70      ; 4.11  ROM Mirror configuration
                                           71      ; 4.12  Flash Security
                                           72      ; 4.13  Flash Write Protection
                                           73      ; 4.14  Boot Vector
                                           74      ; 4.15  UART scanning
                                           75      ; 4.16  Enable RAMCODE Copying
                                           76      ; 4.17  Enable information stamp in ROM
                                           77      ; 4.18  Enable Background Debugging Mode
                                           78      ;
                                           79      ; 5  Section and Data Declaration
                                           80      ; 5.1   Several fixed addresses (fixed for MB963
                                                   xx controllers)
                                           81      ; 5.2   Set ROM Configuration for Boot Vector
                                           82      ; 5.3   Set ROM configuration for UART Scanning
                                           83      ; 5.4   Store version information
                                           84      ; 5.5   Declaration of __near addressed data sec
                                                   tions
                                           85      ; 5.6   Declaration of RAMCODE section and label
                                                   s
                                           86      ; 5.7   Declaration of sections containing other
                                                    sections description
                                           87      ; 5.8   Stack area and stack top definition/decl
                                                   aration
                                           88      ; 5.9   Direct page register dummy label definit
                                                   ion
                                           89      ; 5.10  Set Flash Security
                                           90      ; 5.11  Set Flash write protection
                                           91      ; 5.12  Debug address specification
                                           92      ;
                                           93      ; 6  Start-Up Code
                                           94      ; 6.1   Import external symbols
                                           95      ; 6.2   Program start (the reset vector should p
                                                   oint here)
                                           96      ; 6.3   "NOT RESET YET" WARNING
                                           97      ; 6.4   Initialisation of processor status
                                           98      ; 6.5   Set clock ratio (ignore subclock)
                                           99      ; 6.6   Set external bus configuaration
                                          100      ; 6.7   Prepare stacks and set the default stack
                                                    type
                                          101      ; 6.8   Copy initial values to data areas.
                                          102      ; 6.9   Clear uninitialized data areas to zero
                                          103      ; 6.10  Set Data Bank Register (DTB) and Direct
                                                   Page Register (DPR)
                                          104      ; 6.11  ICU register initialization workaround
                                          105      ; 6.12  Wait for clocks to stabilize
                                          106      ; 6.13  Initialise Low-Level Library Interface
                                          107      ; 6.14  Call C-language main function
                                          108      ; 6.15  Shut down library
                                          109      ; 6.16  Program end loop
                                          110      ;
                                          111      ;===============================================
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   6
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   =====================
                                          112      ; 3  History
                                          113      ;===============================================
                                                   =====================
                                          114      ; Id: START.ASM 4041 2009-10-29 08:40:57Z rlande

                                          115
                                          116      #define VERSION  "1.59"
                                          117      /*
                                          118      Revision 1.59 4041 2009-10-29 08:40:57Z rlande
                                          119      - changed: configuration sequence of CSs for ext
                                                   ernal vector mode.
                                          120
                                          121      Revision 1.58 Id: START.ASM 3798 2009-09-29 08:4
                                                   6:42Z rlande
                                          122      - added: mode byte setting for external vector m
                                                   ode
                                          123
                                          124      Revision 1.57 Id: START.ASM 3734 2009-09-03 08:5
                                                   7:19Z rlande
                                          125      - added: Check of clock settings for MB96384RxA,
                                                    MB96384YxA
                                          126
                                          127      Revision 1.56 Id: START.ASM 3700 2009-08-24 15:3
                                                   8:49Z rlande
                                          128      - added: CLOCK_OPTIMIZATION setting
                                          129      - corrected: Flash B timing setup
                                          130      - corrected: System stack pointer initialization
                                                    if C lib is used
                                          131
                                          132      Revision 1.55 Id: START.ASM 3360 2009-07-24 12:2
                                                   9:46Z rlande
                                          133      - removed: series MB96360
                                          134
                                          135      Revision 1.54 Id: START.ASM 3179 2009-07-03 08:5
                                                   3:18Z rlande
                                          136      - added: devices MB96378HxB, MB96379RxB, MB96388
                                                   HxB, MB96389RxB
                                          137      - changed: Security settings for compatibility t
                                                   o mask ROM
                                          138
                                          139      Revision 1.53 3144 2009-06-30 12:04:28Z rlande
                                          140      - corrected: Stack initialization if stack is at
                                                    end of bank
                                          141      - changed: Stack settings are generated from sec
                                                   tion instead of symbols.
                                          142      - note: Stack symbols are still generated for co
                                                   nvenience
                                          143
                                          144      Revision 1.52 3055 2009-06-08 09:11:01Z rlande
                                          145      - updated: disclaimer
                                          146
                                          147      Revision 1.51 3036 2009-05-25 15:05:50Z rlande
                                          148      - added: Clock setting CPU_56MHZ_CLKP2_8MHZ
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   7
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          149
                                          150      Revision 1.50 2997 2009-05-12 13:55:42Z rlande
                                          151      - added: initialization of stack and global vari
                                                   ables
                                          152        outside bank 0.
                                          153
                                          154      Revision 1.49 2942 2009-04-30 15:42:36Z rlande
                                          155      - added: Clock setting CPU_48MHZ_CLKP1_16MHZ_CLK
                                                   P2_CLKP3_MAIN.
                                          156      - changed: Implementation of clock setting CPU_4
                                                   MHZ_MAIN_CLKP2_4MHZ.
                                          157
                                          158      Revision 1.48 2908 2009-04-22 10:41:52Z rlande
                                          159      - corrected: initialization of user stack
                                          160
                                          161      Revision 1.47 2868 2009-04-06 15:16:06Z rlande
                                          162      - added: Devices MB96313RxA, MB96313AxA, MB96315
                                                   AxA, MB96336UxA, MB96353RxA,
                                          163        MB96353AxA, MB96355AxA
                                          164
                                          165      Revision 1.46 2780 2009-03-13 15:27:28Z rlande
                                          166      - added: Devices MB96326RxB, MB96326YxB, MB96356
                                                   RxB, MB96356YxB
                                          167      - added: Crystal setting 16MHz
                                          168      - added: Clock setting CPU_48MHZ_CLKP1_16MHZ_CLK
                                                   P2_16MHZ
                                          169
                                          170      Revision 1.45  2748 2009-03-12 14:51:16Z rlande
                                          171      - added: Devices MB96345DxA
                                          172
                                          173      Revision 1.44  2477 2009-01-21 10:23:48Z rlande
                                          174      - corrected: clock VCO in PLL clock settings 4MH
                                                   z to 12MHz.
                                          175      - added: Preprocessor guard for illegal clock VC
                                                   O settings.
                                          176
                                          177      Revision 1.43  2475 2009-01-16 15:31:58Z rlande
                                          178      - added: Clock setting CPU_24MHZ_CLKP2_24MHZ.
                                          179
                                          180      Revision 1.42  2452 2008-12-03 16:38:01Z rlande
                                          181      - changed: Series numbering
                                          182      - added: Series MB96315
                                          183      - added: devices MB96315RxA, MB96355RxA
                                          184      - added: check for illegal ext bus settings
                                          185      - changed: moved ROM-cfg settings to chapter 5
                                          186      - updated: chapter headings to common format
                                          187      - updated: table of contents
                                          188
                                          189      Revision 1.41  2428 2008-10-28 19:46:25Z rlande
                                          190      - added: Series MB96910
                                          191      - added: Device MB96918DxA
                                          192      - added: DataFlash A security feature
                                          193
                                          194      Revision 1.40  2008/09/05 11:21:39  rlande
                                          195      - added: Clock restrictions for MB96395RxA
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   8
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          196
                                          197      Revision 1.39  2008/08/18 07:30:14  rlande
                                          198      - revised: All clock settings
                                          199
                                          200      Revision 1.38  2008/07/01 15:23:31  rlande
                                          201      - changed: CLKP3 setting for CPU_48MHZ_CLKP2_16M
                                                   HZ. Now 48MHz.
                                          202
                                          203      Revision 1.37  2008/06/30 17:21:03  rlande
                                          204      - corrected clock settings 32 MHz to 48 MHz
                                          205
                                          206      Revision 1.36  2008/06/24 15:34:14  rlande
                                          207      - added sector protection for S28, S29, S30, S31
                                                    (available on MB96379R)
                                          208
                                          209      Revision 1.35  2008/06/23 14:39:23  rlande
                                          210      - renamed CPU_40MHz_CLKP2_16MHZ to CPU_40MHZ_CLK
                                                   P2_16MHZ
                                          211
                                          212      Revision 1.34  2008/06/10 15:48:17  rlande
                                          213      - update: flash timing settings
                                          214
                                          215      Revision 1.33  2008/06/10 15:19:36  rlande
                                          216      - added: limitation to 48 MHz for 330 series
                                          217      - added: limitation to 40 MHz for 370 series
                                          218      - added: 40 MHz clock setting
                                          219
                                          220      Revision 1.32  2008/04/30 08:00:50  rlande
                                          221      - FLASH_B_AVAILABLE changed to macro that is cal
                                                   culated from SERIES and DEVICE
                                          222
                                          223      Revision 1.31  2008/02/27 10:23:34  mcuae
                                          224      - CPU_48MHZ_CLKP1_32MHZ_CLKP2_16MHZ clock settin
                                                   g added
                                          225
                                          226      Revision 1.30  2008/02/26 15:28:21  mcuae
                                          227      - clock settings corrected
                                          228      - Main/Satellite Flash term outdated, now: Flash
                                                    A, Flash B
                                          229
                                          230      Revision 1.29  2008/02/11 15:26:33  mwilla
                                          231      - device configuration for ext. bus i/f settings
                                                    updated
                                          232
                                          233      Revision 1.28  2008/01/25 08:03:48  mwilla
                                          234      - clock settings corrected and optimized
                                          235
                                          236      Revision 1.27  2008/01/04 12:26:08  mwilla
                                          237      - device list expanded
                                          238      - clock settings optimized
                                          239
                                          240      Revision 1.26  2007/10/17 11:53:34  mwilla
                                          241      - device list expanded
                                          242      - ICU initialization workaround added
                                          243      - sections settings grouped
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:   9
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          244
                                          245      Revision 1.25  2007/09/28 07:33:18  mwilla
                                          246      - Bug in BDM baudrate calculation corrected
                                          247
                                          248      Revision 1.24  2007/09/26 14:03:08  mwilla
                                          249      - Device list for MB96340 series updated and exp
                                                   anded
                                          250
                                          251      Revision 1.23  2007/08/06 14:48:16  mwilla
                                          252      - BDM section always reserved, filled with 0xFF,
                                                    if not configured
                                          253
                                          254      Revision 1.22  2007/08/02 08:34:03  mwilla
                                          255      - communication mode bits of BDM configuration g
                                                   rouped
                                          256
                                          257      Revision 1.21  2007/07/13 08:23:05  mwilla
                                          258      - device selection for BDM baud rate improved
                                          259
                                          260      Revision 1.20  2007/06/12 10:43:57  mwilla
                                          261      - BDM-Baud-Rate calculation includes crystal fre
                                                   quency
                                          262
                                          263      Revision 1.19  2007/06/06 07:46:55  mwilla
                                          264      - add Background Debugging Configuration
                                          265      - Stack initialization moved before variable ini
                                                   tialization
                                          266      - values of cystal frequency and device macros c
                                                   hanged
                                          267
                                          268      Revision 1.18  2007/04/16 07:56:02  phuene
                                          269      - update clock settings when crystal is 8 MHz so
                                                    that the CLKVCO is low
                                          270
                                          271      Revision 1.17  2007/04/10 11:30:43  phuene
                                          272      - add MB96320 Series
                                          273      - Clock settings optimized for CPU_8MHZ_CLKP2_8M
                                                   HZ, CPU_12MHZ_CLKP2_12MHZ, CPU_16MHZ_CLKP2_16MHZ
                                                   , CPU_24MHZ_CLKP2_24MHZ, CPU_32MHZ_CLKP2_32MHZ
                                          274      - make the selection for the individual devices
                                                   also consider the selected Series
                                          275      - support 8 MHz crystal
                                          276      - add clock setting CPU_32MHZ_CLKP1_16MHZ_CLKP2_
                                                   16MHZ
                                          277      - prohibit CPU_32MHZ_CLKP2_16MHZ, CPU_CLKP1_16MH
                                                   Z_CLKP2_16MHZ for MB96F348H and MB96F348T accord
                                                   ing to functional limitation 16FXFL0014
                                          278
                                          279      Revision 1.16  2007/02/07 12:38:10  phuene
                                          280      - support disabling the UART scanning in Interna
                                                   l Vector Mode
                                          281      - distinguish between Reset Vector and Boot Vect
                                                   or: the Boot Vector points to the start of the u
                                                   ser application
                                          282
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  10
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          283      Revision 1.15  2007/02/07 09:00:19  phuene
                                          284      - add .SKIP instructions to occupy the whole ROM
                                                    configuration block area
                                          285
                                          286      Revision 1.14  2007/01/29 13:15:06  phuene
                                          287      - fix CPU_4MHZ_MAIN_CLKP2_4MHZ clock setting
                                          288
                                          289      Revision 1.13  2007/01/03 10:40:14  phuene
                                          290      - change clock setting CPU_24MHZ_CLKP2_16MHZ to
                                                   CPU_24MHZ_CLKP2_12MHZ; this allows for better pe
                                                   rformance of MB96F348H/T
                                          291      - use additional preprocessor statements to avoi
                                                   d checking for PLL ready twice in some cases
                                          292
                                          293      Revision 1.12  2007/01/02 10:16:20  phuene
                                          294      - correct CLKP2 (CAN) clock for CPU_32MHZ and MB
                                                   96F348H/T
                                          295      - correct CLKP2 (CAN) clock for CPU_24MHZ for al
                                                   l other devices than MB96F348H/T
                                          296
                                          297      Revision 1.11  2006/12/28 10:49:52  phuene
                                          298      - corrected PLL setting for CPU_16MHZ for MB9634
                                                   8H, MB96348T
                                          299
                                          300      Revision 1.10  2006/12/28 08:41:57  phuene
                                          301      - correct revision number at new location
                                          302
                                          303      Revision 1.1  2006/12/28 07:20:01  phuene
                                          304      - new location in CVS
                                          305
                                          306      Revision 1.9  2006/12/27 13:00:45  phuene
                                          307      - add support for ROM Mirror when using the Simu
                                                   lator
                                          308      - add support for 16FXFL0022, 16FXFL0023
                                          309
                                          310      Revision 1.8  2006/12/11 16:43:37  phuene
                                          311      - fix typo
                                          312
                                          313      Revision 1.7  2006/12/11 16:35:08  phuene
                                          314      - add setting for Clock Stabilization Times
                                          315      - modify clock settings:
                                          316        - CLKP2 < 28 MHz
                                          317        - remove clock settings using more wait cycles
                                                    than absolutely required
                                          318
                                          319      Revision 1.6  2006/11/03 13:38:45  phuene
                                          320      - modify clock settings to also set the Flash Me
                                                   mory Timing
                                          321      - add support for both parameter passing models
                                          322
                                          323      Revision 1.5  2006/08/07 14:01:44  phuene
                                          324      - change default clock setting to PLLx4 for CLKS
                                                   1, CLKS2
                                          325      - correct clock setting
                                          326      - disable Flash Security by default for Main Fla
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  11
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   sh, Satellite Flash
                                          327      - disable availability of Satellite Flash by def
                                                   ault
                                          328
                                          329      Revision 0.4  2006/08/07 15:35:35  phu
                                          330      - change default clock setting to PLLx4 for CLKS
                                                   1, CLKS2
                                          331      - correct clock setting
                                          332      - disable Flash Security by default for Main Fla
                                                   sh, Satellite Flash
                                          333      - disable availability of Satellite Flash by def
                                                   ault
                                          334
                                          335      Revision 0.3  2006/07/14 15:37:46  phu
                                          336      - add MB96350 Series
                                          337      - correct PIER settings for HRQ and RDY signals
                                          338
                                          339      Revision 0.2  2006/07/14 15:37:46  phu
                                          340      - include PIER settings for External Bus operati
                                                   on
                                          341
                                          342      Revision 0.1  2006/01/25 15:37:46  phu
                                          343      - initial version based on start.asm for MB90340
                                                    Series, version 3.8
                                          344      */
                                          345      ;===============================================
                                                   =====================
                                          346
                                          347      ;===============================================
                                                   =====================
                                          348      ; 4  Settings
                                          349      ;===============================================
                                                   =====================
                                          350      ;
                                          351      ; CHECK ALL OPTIONS WHETHER THEY FIT TO THE APPL
                                                   ICATION
                                          352      ;
                                          353      ; Configure this startup file in the "Settings"
                                                   section. Search for
                                          354      ; comments with leading "; <<<". This points to
                                                   the items to be set.
                                          355      ;===============================================
                                                   =====================
                                          356      #set      OFF       0
                                          357      #set      ON        1
                                          358
                                          359      ;===============================================
                                                   =====================
                                          360      ; 4.1   Controller Series, Device
                                          361      ;===============================================
                                                   =====================
                                          362
                                          363      #set      MB96310   310
                                          364      #set      MB96320   320
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  12
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          365      #set      MB96330   330
                                          366      #set      MB96340   340
                                          367      #set      MB96350   350
                                          368      #set      MB96370   370
                                          369      #set      MB96380   380
                                          370      #set      MB96390   390
                                          371      #set      MB96910   910
                                          372
                                          373      #set      SERIES    MB96340        ; <<< select
                                                   Series
                                          374
                                          375
                                          376      ; Please specify the device according to the fol
                                                   lowing selection;
                                          377      ; x = {W, S}.
                                          378      ; Note: Do not change order because of device nu
                                                   mber dependency in
                                          379      ; 6.5 Clock settings, 5.9 Debug address specific
                                                   ation,
                                          380      ; and 6.11 ICU register initialization workaroun
                                                   d!
                                          381
                                          382      ; MB96310 series
                                          383      #set      MB96315RxA   1
                                          384      #set      MB96315AxA   2
                                          385      #set      MB96313RxA   3
                                          386      #set      MB96313AxA   4
                                          387
                                          388      ; MB96320 series
                                          389      #set      MB96326RxA   1
                                          390      #set      MB96326YxA   2
                                          391      #set      MB96326RxB   3
                                          392      #set      MB96326YxB   4
                                          393
                                          394      ; MB96330 series
                                          395      #set      MB96338RxA   1
                                          396      #set      MB96338UxA   2
                                          397      #set      MB96336UxA   3
                                          398
                                          399      ; MB96340 series
                                          400      #set      MB96348HxA   1
                                          401      #set      MB96348TxA   2
                                          402      #set      MB96346RxA   3
                                          403      #set      MB96346YxA   4
                                          404      #set      MB96346AxA   5
                                          405      #set      MB96347RxA   6
                                          406      #set      MB96347YxA   7
                                          407      #set      MB96347AxA   8
                                          408      #set      MB96348RxA   9
                                          409      #set      MB96348YxA  10
                                          410      #set      MB96348AxA  11
                                          411      #set      MB96346RxB  12
                                          412      #set      MB96346AxB  13
                                          413      #set      MB96346YxB  14
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  13
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          414      #set      MB96347RxB  15
                                          415      #set      MB96347AxB  16
                                          416      #set      MB96347YxB  17
                                          417      #set      MB96348CxA  18
                                          418      #set      MB96348HxB  19
                                          419      #set      MB96348TxB  20
                                          420      #set      MB96348RxB  21
                                          421      #set      MB96348AxB  22
                                          422      #set      MB96348YxB  23
                                          423      #set      MB96348CxC  24
                                          424      #set      MB96348HxC  25
                                          425      #set      MB96348TxC  26
                                          426      #set      MB96345DxA  27
                                          427
                                          428      ; MB96350 series
                                          429      #set      MB96356RxA   1
                                          430      #set      MB96356YxA   2
                                          431      #set      MB96355RxA   3
                                          432      #set      MB96356RxB   4
                                          433      #set      MB96356YxB   5
                                          434      #set      MB96355AxA   6
                                          435      #set      MB96353RxA   7
                                          436      #set      MB96353AxA   8
                                          437
                                          438      ; MB96370 series
                                          439      #set      MB96379RxA   1
                                          440      #set      MB96379YxA   2
                                          441      #set      MB96379RxB   3
                                          442      #set      MB96378HxB   4
                                          443
                                          444      ; MB96380 series
                                          445      #set      MB96384RxA   1
                                          446      #set      MB96384YxA   2
                                          447      #set      MB96385RxA   3
                                          448      #set      MB96385YxA   4
                                          449      #set      MB96386RxA   5
                                          450      #set      MB96386YxA   6
                                          451      #set      MB96387RxA   7
                                          452      #set      MB96387YxA   8
                                          453      #set      MB96386RxB   9
                                          454      #set      MB96386YxB  10
                                          455      #set      MB96387RxB  11
                                          456      #set      MB96387YxB  12
                                          457      #set      MB96388HxB  13
                                          458      #set      MB96389RxB  14
                                          459
                                          460      ; MB96390 series
                                          461      #set      MB96395RxA   1
                                          462
                                          463      ; MB96910 series
                                          464      #set      MB96918DxA   1
                                          465
                                          466
                                          467      #set      DEVICE    MB96348RxB      ; <<< select
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  14
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                    device
                                          468
                                          469      ;===============================================
                                                   =====================
                                          470      ; 4.2   C-language Memory model
                                          471      ;===============================================
                                                   =====================
                                          472
                                          473                                         ;      data
                                                       code
                                          474      #set      SMALL     0              ;     16 Bit
                                                      16 Bit
                                          475      #set      MEDIUM    1              ;     16 Bit
                                                      24 Bit
                                          476      #set      COMPACT   2              ;     24 Bit
                                                      16 Bit
                                          477      #set      LARGE     3              ;     24 Bit
                                                      24 Bit
                                          478      #set      AUTOMODEL 4              ; works alway
                                                   s, might occupy two
                                          479                                         ; additional
                                                   bytes
                                          480
                                          481
                                          482      #set      MEMMODEL  AUTOMODEL      ; <<< C-memor
                                                   y model
                                          483
                                          484      ; The selected memory model should be set in ord
                                                   er to fit to the
                                          485      ; model selected for the compiler.
                                          486      ; Note, in this startup version AUTOMODEL will w
                                                   ork for all
                                          487      ; C-models. However, if the compiler is configur
                                                   ed for SMALL or
                                          488      ; COMPACT, two additional bytes on stack are occ
                                                   upied. If this is not
                                          489      ; acceptable, the above setting should be set to
                                                    the correct model.
                                          490
                                          491      ;===============================================
                                                   =====================
                                          492      ; 4.3   Function-Call Interface
                                          493      ;===============================================
                                                   =====================
                                          494
                                          495                #if __REG_PASS__
                                          496   X              .REG_PASS
                                          497                #endif
                                          498
                                          499      ; Above statement informs Assembler on compatibi
                                                   lity of start-up code
                                          500      ; to  Function Call Interface  as selected for t
                                                   he application. There
                                          501      ; is nothing to configure.
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  15
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          502      ; The Function-Call Interface specifies the meth
                                                   od of passing parame-
                                          503      ; ter from function caller to callee.  The stand
                                                   ard method of FCC907S
                                          504      ; compiler  uses  "stack argument passing".  Alt
                                                   ernatively,  language
                                          505      ; tools can be configured for "register argument
                                                    passing".
                                          506      ; For details see the compiler manual.
                                          507      ; This start-up file is compatible to both inter
                                                   faces.
                                          508
                                          509      ;===============================================
                                                   =====================
                                          510      ; 4.4   Constant Data Handling
                                          511      ;===============================================
                                                   =====================
                                          512
                                          513      #set      ROMCONST    0            ; works only
                                                   with compiler ROMCONST
                                          514      #set      RAMCONST    1            ; works with
                                                   BOTH compiler settings
                                          515      #set      AUTOCONST   RAMCONST     ; works with
                                                   BOTH compiler settings
                                          516
                                          517      #set      CONSTDATA   AUTOCONST    ; <<< set RAM
                                                   /ROM/AUTOCONST
                                          518
                                          519      ; - AUTOCONST (default) is the same as RAMCONST
                                          520      ; - RAMCONST/AUTOCONST should always work, even
                                                   if compiler is set to
                                          521      ;   ROMCONST. If compiler is set to ROMCONST and
                                                    this startup file is
                                          522      ;   set to RAMCONST or AUTOCONST, this startup f
                                                   ile will generate an
                                          523      ;   empty section CINIT in RAM. However, the cod
                                                   e, which copies from
                                          524      ;   CONST to CINIT will not have any effect, bec
                                                   ause size of section is 0.
                                          525      ; - It is highly recommended to set the compiler
                                                    to ROMCONST for
                                          526      ;   single-chip mode or internal ROM+ext bus. Th
                                                   e start-up file
                                          527      ;   should be set to AUTOCONST.
                                          528      ; - ROMCONST setting on systems with full extern
                                                   al bus requires exter-
                                          529      ;   nal address mapping.
                                          530      ;   Single-chip can be emulated by the emulator
                                                   debugger.
                                          531      ;   ROM mirror can also be used with simulator.
                                          532      ;
                                          533      ; see also ROM MIRROR options
                                          534
                                          535      ;===============================================
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  16
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   =====================
                                          536      ; 4.5   Stack Type and Stack Size
                                          537      ;===============================================
                                                   =====================
                                          538
                                          539      #set      USRSTACK       0      ; user stack: fo
                                                   r main program
                                          540      #set      SYSSTACK       1      ; system stack:
                                                   for main program and interrupts
                                          541
                                          542      #set      STACKUSE  SYSSTACK    ; <<< set active
                                                    stack
                                          543
                                          544      #set      STACK_RESERVE  ON     ; <<< reserve st
                                                   ack area in this module
                                          545      #set      STACK_SYS_SIZE 768    ; <<< byte size
                                                   of System stack
                                          546      #set      STACK_USR_SIZE 2      ; <<< byte size
                                                   of User stack
                                          547
                                          548      #set      STACK_FILL     ON     ; <<< fills the
                                                   stack area with pattern
                                          549      #set      STACK_PATTERN  0x55AA ; <<< the patter
                                                   n to write to stack
                                          550
                                          551      ; - If the active stack is set to SYSSTACK, it i
                                                   s used for main program
                                          552      ;   and interrupts. In this case, the user stack
                                                    can be set to a dummy
                                          553      ;   size.
                                          554      ;   If the active stack is set to user stack, it
                                                    is used for the main
                                          555      ;   program but the system stack is automaticall
                                                   y activated, if an inter-
                                          556      ;   rupt is serviced. Both stack areas must have
                                                    a reasonable size.
                                          557      ; - If STACK_RESERVE is ON, the sections USTACK
                                                   and SSTACK are reserved
                                          558      ;   in this module. Otherwise, they have to be r
                                                   eserved in other modules.
                                          559      ;   If STACK_RESERVE is OFF, the size definition
                                                   s STACK_SYS_SIZE and
                                          560      ;   STACK_USR_SIZE have no meaning.
                                          561      ; - Even if they are reserved in other modules,
                                                   they are still initialised
                                          562      ;   in this start-up file.
                                          563      ; - Filling the stack with a pattern allows to d
                                                   ynamically check the stack
                                          564      ;   area, which had already been used.
                                          565      ;
                                          566      ; - If only system stack is used and SSB is link
                                                   ed to a different bank
                                          567      ;   than USB, make sure that all C-modules (whic
                                                   h generate far pointers
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  17
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          568      ;   to stack data) have "#pragma SSB". Applies o
                                                   nly to exclusive confi-
                                          569      ;   gurations.
                                          570      ; - Note, several library functions require quit
                                                   e a big stack (due to
                                          571      ;   ANSI). Check the stack information files (*.
                                                   stk) in the LIB\907
                                          572      ;   directory.
                                          573
                                          574      ;===============================================
                                                   =====================
                                          575      ; 4.6   General Register Bank
                                          576      ;===============================================
                                                   =====================
                                          577
                                          578      #set      REGBANK   0           ; <<< set defaul
                                                   t register bank
                                          579
                                          580      ; set the General Register Bank that is to be us
                                                   ed after startup.
                                          581      ; Usually, this is bank 0, which applies to addr
                                                   ess H'180..H'18F. Set
                                          582      ; in the range from 0 to 31.
                                          583      ; Note: All used register banks have to be reser
                                                   ved (linker options).
                                          584
                                          585      #if REGBANK > 31 || REGBANK < 0
                                          586   X  #  error REGBANK setting out of range
                                          587      #endif
                                          588
                                          589      ;===============================================
                                                   =====================
                                          590      ; 4.7   Low-Level Library Interface
                                          591      ;===============================================
                                                   =====================
                                          592
                                          593      #set      CLIBINIT       OFF    ; <<< select ext
                                                   ended library usage
                                          594
                                          595      ; This option has only to be set, if stream-IO/s
                                                   tandard-IO function of
                                          596      ; the C-library have to be used (printf(), fopen
                                                   ()...). This also
                                          597      ; requires low-level functions to be defined by
                                                   the application
                                          598      ; software.
                                          599      ; For other library functions (like e.g. sprintf
                                                   ()) all this is not
                                          600      ; necessary. However, several functions consume
                                                   a large amount of stack.
                                          601
                                          602      ;===============================================
                                                   =====================
                                          603      ; 4.8   Clock Selection
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  18
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          604      ;===============================================
                                                   =====================
                                          605
                                          606      ; The clock selection requires that a 4 MHz or 8
                                                    MHz external clock
                                          607      ; is provided as the Main Clock. If a different
                                                   frequency is used,
                                          608      ; the Flash Memory Timing settings must be check
                                                   ed!
                                          609
                                          610      #set      CLOCKWAIT      ON     ; <<<  wait for
                                                   stabilized clock, if
                                          611                                      ;      Main Cloc
                                                   k or PLL is used
                                          612
                                          613      ; The clock is set quite early. However, if CLOC
                                                   KWAIT is ON, polling
                                          614      ; for machine clock to be switched to Main Clock
                                                    or PLL is done at
                                          615      ; the end of this file. Therefore, the stabiliza
                                                   tion time is not
                                          616      ; wasted. Main() will finally start at correct s
                                                   peed. Resources can
                                          617      ; be used immediately.
                                          618      ; Note: If CLOCKWAIT is switched off, Flash timi
                                                   ng settings may
                                          619      ; be set to a value that is slower than optimal.
                                          620      ;
                                          621      ; This startup file version does not support sub
                                                   clock.
                                          622
                                          623      #set      FREQ_4MHZ       D'4000000L
                                          624      #set      FREQ_8MHZ       D'8000000L
                                          625      #set      FREQ_16MHZ      D'16000000L
                                          626
                                          627      #set      CRYSTAL         FREQ_8MHZ  ; <<< selec
                                                   t external crystal frequency
                                          628
                                          629      #set      CPU_4MHZ_MAIN_CLKP2_4MHZ            0x
                                                   00000000L
                                          630      #set      CPU_4MHZ_PLL_CLKP2_4MHZ             0x
                                                   04040404L
                                          631      #set      CPU_8MHZ_CLKP2_8MHZ                 0x
                                                   08080808L
                                          632      #set      CPU_12MHZ_CLKP2_12MHZ               0x
                                                   0C0C0C0CL
                                          633      #set      CPU_16MHZ_CLKP2_16MHZ               0x
                                                   10101010L
                                          634      #set      CPU_24MHZ_CLKP2_12MHZ               0x
                                                   18180C18L
                                          635      #set      CPU_24MHZ_CLKP2_16MHZ               0x
                                                   18181018L
                                          636      #set      CPU_24MHZ_CLKP2_24MHZ               0x
                                                   18181818L
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  19
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          637      #set      CPU_32MHZ_CLKP2_16MHZ               0x
                                                   20201020L
                                          638      #set      CPU_32MHZ_CLKP1_16MHZ_CLKP2_16MHZ   0x
                                                   20101020L
                                          639      #set      CPU_40MHZ_CLKP2_16MHZ               0x
                                                   28281028L
                                          640      #set      CPU_48MHZ_CLKP2_16MHZ               0x
                                                   30301030L
                                          641      #set      CPU_48MHZ_CLKP1_32MHZ_CLKP2_16MHZ   0x
                                                   30201030L
                                          642      #set      CPU_48MHZ_CLKP1_16MHZ_CLKP2_16MHZ   0x
                                                   30101030L
                                          643      #set      CPU_48MHZ_CLKP1_16MHZ_CLKP2_CLKP3_MAIN
                                                     0x30100030L
                                          644      #set      CPU_56MHZ_CLKP2_8MHZ                0x
                                                   38380838L
                                          645      #set      CPU_56MHZ_CLKP2_14MHZ               0x
                                                   38380E38L
                                          646
                                          647      #set      CLOCK_SPEED     CPU_8MHZ_CLKP2_8MHZ  ;
                                                    <<< set clock speeds
                                          648
                                          649      ; If not specified seperately, the peripheral cl
                                                   ock CLKP1 is set to
                                          650      ; the same frequency as the CPU.
                                          651      ; The peripheral clock CLKP2 has its setting. Th
                                                   is is because it
                                          652      ; feeds only the CAN controllers and Sound Gener
                                                   ators. These do not
                                          653      ; need high frequency clocks.
                                          654      ; If available CLKP3 is set to the same frequenc
                                                   y as the CPU.
                                          655
                                          656      #set      WAIT_STATE_OPTIMIZATION  2
                                          657      #set      LOW_PLL_OPTIMIZATION     1
                                          658
                                          659      #set      CLOCK_OPTIMIZATION   WAIT_STATE_OPTIMI
                                                   ZATION ; <<< set clock optimization mode
                                          660
                                          661      ; For some clock settings there are several poss
                                                   ible frequency settings
                                          662      ; for the internal PLL. These settings can have
                                                   impact on the flash
                                          663      ; wait state settings (execution spedd) as well
                                                   as the power consumption.
                                          664      ;
                                          665      ; If "WAIT_STATE_OPTIMIZATION" is selected, a PL
                                                   L setting with minimum
                                          666      ; flash wait states is applied. This can incease
                                                    performance. Note that
                                          667      ; "WAIT_STATE_OPTIMIZATION" is not supported for
                                                    some combinations of
                                          668      ; devices and clock settings. If the setting is
                                                   not supported, a
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  20
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          669      ; pre-processor error will be generated.
                                          670      ;
                                          671      ; If "LOW_PLL_OPTIMIZATION" is selected, a PLL s
                                                   etting with minimum
                                          672      ; internal frequency is applied. This can decrea
                                                   se power consumption.
                                          673      ; Note that "LOW_PLL_OPTIMIZATION" is supported
                                                   for all combinations of
                                          674      ; devices and clock settings that allow the give
                                                   n external clock settings.
                                          675
                                          676      ;===============================================
                                                   =====================
                                          677      ; 4.9   Clock Stabilization Time
                                          678      ;===============================================
                                                   =====================
                                          679
                                          680      ; Main clock stabilization time is given in cloc
                                                   k cycles, where
                                          681      ; MC_2_X_CYCLES means 2 to power of X cycles.
                                          682
                                          683      #set      MC_2_10_CYCLES   0
                                          684      #set      MC_2_12_CYCLES   1
                                          685      #set      MC_2_13_CYCLES   2
                                          686      #set      MC_2_14_CYCLES   3
                                          687      #set      MC_2_15_CYCLES   4
                                          688      #set      MC_2_16_CYCLES   5
                                          689      #set      MC_2_17_CYCLES   6
                                          690      #set      MC_2_18_CYCLES   7
                                          691
                                          692      #set      MC_STAB_TIME     MC_2_15_CYCLES ; <<<
                                                   select Main Clock Stabilization Time
                                          693
                                          694      ;===============================================
                                                   =====================
                                          695      ; 4.10  External Bus Interface
                                          696      ;===============================================
                                                   =====================
                                          697
                                          698      #set      SINGLE_CHIP     0        ; all interna
                                                   l
                                          699      #set      INTROM_EXTBUS   1        ; mask ROM or
                                                    FLASH memory used
                                          700      #set      EXTROM_EXTBUS   2        ; full extern
                                                   al bus (INROM not used)
                                          701
                                          702      #set      BUSMODE SINGLE_CHIP      ; <<< set bus
                                                    mode (see mode pins)
                                          703
                                          704      #set      MULTIPLEXED     0        ;
                                          705      #set      NON_MULTIPLEXED 1        ; only if sup
                                                   ported by the device
                                          706
                                          707      #set      ADDRESSMODE MULTIPLEXED  ; <<< set add
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  21
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   ress-mode
                                          708
                                          709      ; Some devices support multiplexed and/or non-mu
                                                   ltiplexed Bus mode
                                          710      ; please refer to the related datasheet/hardware
                                                   manual
                                          711
                                          712
                                          713      ; If BUSMODE is "SINGLE_CHIP", ignore remaining
                                                   bus settings.
                                          714
                                          715      ; Select the used Chip Select areas
                                          716      #set      CHIP_SELECT0       OFF   ; <<< enable
                                                   chip select area
                                          717      #set      CHIP_SELECT1       OFF   ; <<< enable
                                                   chip select area
                                          718      #set      CHIP_SELECT2       OFF   ; <<< enable
                                                   chip select area
                                          719      #set      CHIP_SELECT3       OFF   ; <<< enable
                                                   chip select area
                                          720      #set      CHIP_SELECT4       OFF   ; <<< enable
                                                   chip select area
                                          721      #set      CHIP_SELECT5       OFF   ; <<< enable
                                                   chip select area
                                          722
                                          723      #set      HOLD_REQ           OFF   ; <<< select
                                                   Hold function
                                          724      #set      EXT_READY          OFF   ; <<< select
                                                   external Ready function
                                          725      #set      EXT_CLOCK_ENABLE   OFF   ; <<< select
                                                   external bus clock output
                                          726      #set      EXT_CLOCK_INVERT   OFF   ; <<< select
                                                   clock inversion
                                          727      #set      EXT_CLOCK_SUSPEND  OFF   ; <<< select
                                                   if external clock is suspended when no transfer
                                                   in progress
                                          728
                                          729      ; The external bus clock is derived from core cl
                                                   ock CLKB. Select the divider for the external bu
                                                   s clock.
                                          730
                                          731      #set      EXT_CLOCK_DIV1     0
                                          732      #set      EXT_CLOCK_DIV2     1
                                          733      #set      EXT_CLOCK_DIV4     2
                                          734      #set      EXT_CLOCK_DIV8     3
                                          735      #set      EXT_CLOCK_DIV16    4
                                          736      #set      EXT_CLOCK_DIV32    5
                                          737      #set      EXT_CLOCK_DIV64    6
                                          738      #set      EXT_CLOCK_DIV128   7
                                          739
                                          740      #set      EXT_CLOCK_DIVISION  EXT_CLOCK_DIV1 ; <
                                                   << select clock divider
                                          741
                                          742      #set      ADDR_PINS_23_16    B'00000000     ; <<
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  22
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   < select used address lines
                                          743                                                  ;
                                                     A23..A16 to be output.
                                          744      #set      ADDR_PINS_15_8     B'00000000     ; <<
                                                   < select used address lines
                                          745                                                  ;
                                                     A15..A8 to be output.
                                          746      #set      ADDR_PINS_7_0      B'00000000     ; <<
                                                   < select used address lines
                                          747                                                  ;
                                                     A7..A0 to be output.
                                          748
                                          749      #set      LOW_BYTE_SIGNAL    OFF   ; <<< select
                                                   low byte signal LBX
                                          750      #set      HIGH_BYTE_SIGNAL   OFF   ; <<< select
                                                   high byte signal UBX
                                          751      #set      LOW_WRITE_STROBE   OFF   ; <<< select
                                                   write strobe signal WRLX/WRX
                                          752      #set      HIGH_WRITE_STROBE  OFF   ; <<< select
                                                   write strobe signal WRHX
                                          753      #set      READ_STROBE        OFF   ; <<< select
                                                   read strobe signal RDX
                                          754      #set      ADDRESS_STROBE     OFF   ; <<< select
                                                   address strobe signal ALE/ASX
                                          755      #set      ADDRESS_STROBE_LVL OFF   ; <<< select
                                                   address strobe function: OFF - active low; ON -
                                                   active high
                                          756
                                          757
                                          758      #set      CS0_CONFIG  B'0000000000000000    ; <<
                                                   < select Chip Select Area 0 configuration
                                          759      ;                       |||||||||||||+++-- Autom
                                                   atic wait cycles (0: 0, 1: 1, 2: 2, 3: 3, 4: 4,
                                                   5: 8, 6: 16, 7: 32)
                                          760      ;                       ||||||||||||+----- Addre
                                                   ss Cycle Extension (0: not extended, 1: extensio
                                                   n by 1 cycle)
                                          761      ;                       |||||||||||+------ Strob
                                                   e timing (0: scheme 0, 1: scheme 1)
                                          762      ;                       ||||||||||+------- Write
                                                    strobe function (0: WRLX strobe, 1: WRX strobe)
                                          763      ;                       |||||||||+-------- Endia
                                                   ness (0: little endian, 1: big endian)
                                          764      ;                       ||||||||+--------- Bus w
                                                   idth (0: 16bit, 1: 8bit)
                                          765      ;                       |||||+++---------- ignor
                                                   ed
                                          766      ;                       ||||+------------- Chip
                                                   Select output enable (0: CS disabled, 1: CS enab
                                                   led)
                                          767      ;                       |||+-------------- Chip
                                                   Select level (0: low active, 1: high active)
                                          768      ;                       ||+--------------- Acces
                                                   s type limitation (0: code and data, 1: data onl
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  23
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   y)
                                          769      ;                       ++---------------- ignor
                                                   ed
                                          770
                                          771      #set      CS1_CONFIG  B'0000000000000000    ; <<
                                                   < select Chip Select Area 1 configuration
                                          772      ;                       |||||||||||||+++-- Autom
                                                   atic wait cycles (0: 0, 1: 1, 2: 2, 3: 3, 4: 4,
                                                   5: 8, 6: 16, 7: 32)
                                          773      ;                       ||||||||||||+----- Addre
                                                   ss Cycle Extension (0: not extended, 1: extensio
                                                   n by 1 cycle)
                                          774      ;                       |||||||||||+------ Strob
                                                   e timing (0: scheme 0, 1: scheme 1)
                                          775      ;                       ||||||||||+------- Write
                                                    strobe function (0: WRLX strobe, 1: WRX strobe)
                                          776      ;                       |||||||||+-------- Endia
                                                   ness (0: little endian, 1: big endian)
                                          777      ;                       ||||||||+--------- Bus w
                                                   idth (0: 16bit, 1: 8bit)
                                          778      ;                       |||||+++---------- ignor
                                                   ed
                                          779      ;                       ||||+------------- Chip
                                                   Select output enable (0: CS disabled, 1: CS enab
                                                   led)
                                          780      ;                       |||+-------------- Chip
                                                   Select level (0: low active, 1: high active)
                                          781      ;                       ||+--------------- Acces
                                                   s type limitation (0: code and data, 1: data onl
                                                   y)
                                          782      ;                       ++---------------- ignor
                                                   ed
                                          783
                                          784      #set      CS2_CONFIG  B'0000011000000000    ; <<
                                                   < select Chip Select Area 2 configuration
                                          785      ;                       |||||||||||||+++-- Autom
                                                   atic wait cycles (0: 0, 1: 1, 2: 2, 3: 3, 4: 4,
                                                   5: 8, 6: 16, 7: 32)
                                          786      ;                       ||||||||||||+----- Addre
                                                   ss Cycle Extension (0: not extended, 1: extensio
                                                   n by 1 cycle)
                                          787      ;                       |||||||||||+------ Strob
                                                   e timing (0: scheme 0, 1: scheme 1)
                                          788      ;                       ||||||||||+------- Write
                                                    strobe function (0: WRLX strobe, 1: WRX strobe)
                                          789      ;                       |||||||||+-------- Endia
                                                   ness (0: little endian, 1: big endian)
                                          790      ;                       ||||||||+--------- Bus w
                                                   idth (0: 16bit, 1: 8bit)
                                          791      ;                       |||||+++---------- Exter
                                                   nal area size (0: 64kB, 1: 128kB, 2: 256kB, 3: 5
                                                   12kB, 4: 1MB, 5: 2MB, 6: 4MB, 7: 8MB)
                                          792      ;                       ||||+------------- Chip
                                                   Select output enable (0: CS disabled, 1: CS enab
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  24
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   led)
                                          793      ;                       |||+-------------- Chip
                                                   Select level (0: low active, 1: high active)
                                          794      ;                       ||+--------------- Acces
                                                   s type limitation (0: code and data, 1: data onl
                                                   y)
                                          795      ;                       ++---------------- ignor
                                                   ed
                                          796
                                          797      #set      CS3_CONFIG  B'0000011000000000    ; <<
                                                   < select Chip Select Area 3 configuration
                                          798      ;                       |||||||||||||+++-- Autom
                                                   atic wait cycles (0: 0, 1: 1, 2: 2, 3: 3, 4: 4,
                                                   5: 8, 6: 16, 7: 32)
                                          799      ;                       ||||||||||||+----- Addre
                                                   ss Cycle Extension (0: not extended, 1: extensio
                                                   n by 1 cycle)
                                          800      ;                       |||||||||||+------ Strob
                                                   e timing (0: scheme 0, 1: scheme 1)
                                          801      ;                       ||||||||||+------- Write
                                                    strobe function (0: WRLX strobe, 1: WRX strobe)
                                          802      ;                       |||||||||+-------- Endia
                                                   ness (0: little endian, 1: big endian)
                                          803      ;                       ||||||||+--------- Bus w
                                                   idth (0: 16bit, 1: 8bit)
                                          804      ;                       |||||+++---------- Exter
                                                   nal area size (0: 64kB, 1: 128kB, 2: 256kB, 3: 5
                                                   12kB, 4: 1MB, 5: 2MB, 6: 4MB, 7: 8MB)
                                          805      ;                       ||||+------------- Chip
                                                   Select output enable (0: CS disabled, 1: CS enab
                                                   led)
                                          806      ;                       |||+-------------- Chip
                                                   Select level (0: low active, 1: high active)
                                          807      ;                       ||+--------------- Acces
                                                   s type limitation (0: code and data, 1: data onl
                                                   y)
                                          808      ;                       ++---------------- ignor
                                                   ed
                                          809
                                          810      #set      CS4_CONFIG  B'0000011000000000    ; <<
                                                   < select Chip Select Area 4 configuration
                                          811      ;                       |||||||||||||+++-- Autom
                                                   atic wait cycles (0: 0, 1: 1, 2: 2, 3: 3, 4: 4,
                                                   5: 8, 6: 16, 7: 32)
                                          812      ;                       ||||||||||||+----- Addre
                                                   ss Cycle Extension (0: not extended, 1: extensio
                                                   n by 1 cycle)
                                          813      ;                       |||||||||||+------ Strob
                                                   e timing (0: scheme 0, 1: scheme 1)
                                          814      ;                       ||||||||||+------- Write
                                                    strobe function (0: WRLX strobe, 1: WRX strobe)
                                          815      ;                       |||||||||+-------- Endia
                                                   ness (0: little endian, 1: big endian)
                                          816      ;                       ||||||||+--------- Bus w
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  25
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   idth (0: 16bit, 1: 8bit)
                                          817      ;                       |||||+++---------- Exter
                                                   nal area size (0: 64kB, 1: 128kB, 2: 256kB, 3: 5
                                                   12kB, 4: 1MB, 5: 2MB, 6: 4MB, 7: 8MB)
                                          818      ;                       ||||+------------- Chip
                                                   Select output enable (0: CS disabled, 1: CS enab
                                                   led)
                                          819      ;                       |||+-------------- Chip
                                                   Select level (0: low active, 1: high active)
                                          820      ;                       ||+--------------- Acces
                                                   s type limitation (0: code and data, 1: data onl
                                                   y)
                                          821      ;                       ++---------------- ignor
                                                   ed
                                          822
                                          823      #set      CS5_CONFIG  B'0000011000000000    ; <<
                                                   < select Chip Select Area 5 configuration
                                          824      ;                       |||||||||||||+++-- Autom
                                                   atic wait cycles (0: 0, 1: 1, 2: 2, 3: 3, 4: 4,
                                                   5: 8, 6: 16, 7: 32)
                                          825      ;                       ||||||||||||+----- Addre
                                                   ss Cycle Extension (0: not extended, 1: extensio
                                                   n by 1 cycle)
                                          826      ;                       |||||||||||+------ Strob
                                                   e timing (0: scheme 0, 1: scheme 1)
                                          827      ;                       ||||||||||+------- Write
                                                    strobe function (0: WRLX strobe, 1: WRX strobe)
                                          828      ;                       |||||||||+-------- Endia
                                                   ness (0: little endian, 1: big endian)
                                          829      ;                       ||||||||+--------- Bus w
                                                   idth (0: 16bit, 1: 8bit)
                                          830      ;                       |||||+++---------- Exter
                                                   nal area size (0: 64kB, 1: 128kB, 2: 256kB, 3: 5
                                                   12kB, 4: 1MB, 5: 2MB, 6: 4MB, 7: 8MB)
                                          831      ;                       ||||+------------- Chip
                                                   Select output enable (0: CS disabled, 1: CS enab
                                                   led)
                                          832      ;                       |||+-------------- Chip
                                                   Select level (0: low active, 1: high active)
                                          833      ;                       ||+--------------- Acces
                                                   s type limitation (0: code and data, 1: data onl
                                                   y)
                                          834      ;                       ++---------------- ignor
                                                   ed
                                          835
                                          836
                                          837      #set      CS2_START  0x00       ; <<< select sta
                                                   rt bank of chip select area; valid values: 0x00.
                                                   .0xFF
                                          838      #set      CS3_START  0x40       ; <<< select sta
                                                   rt bank of chip select area; valid values: 0x00.
                                                   .0xFF
                                          839      #set      CS4_START  0x80       ; <<< select sta
                                                   rt bank of chip select area; valid values: 0x00.
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  26
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   .0xFF
                                          840      #set      CS5_START  0xC0       ; <<< select sta
                                                   rt bank of chip select area; valid values: 0x00.
                                                   .0xFF
                                          841
                                          842
                                          843      ;===============================================
                                                   =====================
                                          844      ; 4.11  ROM Mirror configuration
                                          845      ;===============================================
                                                   =====================
                                          846
                                          847      #set      MIRROR_8KB    0
                                          848      #set      MIRROR_16KB   1
                                          849      #set      MIRROR_24KB   2
                                          850      #set      MIRROR_32KB   3
                                          851
                                          852      #set      ROMMIRROR     ON          ; <<< ROM mi
                                                   rror function ON/OFF
                                          853      #set      MIRROR_BANK   0xF         ; <<< ROM Mi
                                                   rror bank, allowed entries: 0x0..0xF for the ban
                                                   ks 0xF0..0xFF
                                          854      #set      MIRROR_SIZE   MIRROR_32KB ; <<< ROM Mi
                                                   rror size
                                          855
                                          856      ; One can select which ROM area to mirror into t
                                                   he upper half of bank 00.
                                          857      ; If ROMMIRROR = OFF is selected, the address ra
                                                   nge 0x008000..0x00FFFF
                                          858      ; shows the contents of the respective area of b
                                                   ank 1: 0x018000..0x01FFFF.
                                          859      ; If ROMMIRROR = ON is selected, the memory bank
                                                    to mirror can be selected.
                                          860      ; Available banks are 0xF0 to 0xFF. Furthermore,
                                                    the ROM Mirror area size can
                                          861      ; be selected. 4 sizes are available: 8 kB, 16 k
                                                   B, 24 kB, or 32 kB. The ROM Mirror
                                          862      ; from the highest address of the selected bank
                                                   downwards, e.g. if bank 0xFF and
                                          863      ; mirror size 24 kB is selected, the memory rang
                                                   e 0xFFA000..0xFFFFFF is mirrored
                                          864      ; to address range 0x00A000..0x00FFFF. The memor
                                                   y area not selected for
                                          865      ; ROM Mirror is still mirrored from bank 0x01.
                                          866      ; This is necessary to get the compiler ROMCONST
                                                    option working. This is intended
                                          867      ; to increase performance, if a lot of dynamic d
                                                   ata have to be accessed.
                                          868      ; In SMALL and MEDIUM model these data can be ac
                                                   cessed within bank 0,
                                          869      ; which allows to use near addressing. Please ma
                                                   ke sure to have the linker
                                          870      ; setting adjusted accordingly!
                                          871
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  27
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          872
                                          873      ;===============================================
                                                   =====================
                                          874      ; 4.12  Flash Security
                                          875      ;===============================================
                                                   =====================
                                          876      ; All settings regarding Flash B are ignored on
                                                   devices that do not
                                          877      ; have a Flash B.
                                          878
                                          879      #set      FLASH_A_SECURITY_ENABLE     OFF ; <<<
                                                   enable Flash Security for Flash A (old "Main Fla
                                                   sh")
                                          880      #set      FLASH_B_SECURITY_ENABLE     OFF ; <<<
                                                   enable Flash Security for Flash B (old "Satellit
                                                   e Flash")
                                          881      #set      DATAFLASH_A_SECURITY_ENABLE OFF ; <<<
                                                   enable Flash Security for DataFlash A
                                          882
                                          883      ; set the Flash Security unlock key (16 bytes)
                                          884      ; all 0: unlock not possible
                                          885      #set      FLASH_A_UNLOCK_0           0x00
                                          886      #set      FLASH_A_UNLOCK_1           0x00
                                          887      #set      FLASH_A_UNLOCK_2           0x00
                                          888      #set      FLASH_A_UNLOCK_3           0x00
                                          889      #set      FLASH_A_UNLOCK_4           0x00
                                          890      #set      FLASH_A_UNLOCK_5           0x00
                                          891      #set      FLASH_A_UNLOCK_6           0x00
                                          892      #set      FLASH_A_UNLOCK_7           0x00
                                          893      #set      FLASH_A_UNLOCK_8           0x00
                                          894      #set      FLASH_A_UNLOCK_9           0x00
                                          895      #set      FLASH_A_UNLOCK_10          0x00
                                          896      #set      FLASH_A_UNLOCK_11          0x00
                                          897      #set      FLASH_A_UNLOCK_12          0x00
                                          898      #set      FLASH_A_UNLOCK_13          0x00
                                          899      #set      FLASH_A_UNLOCK_14          0x00
                                          900      #set      FLASH_A_UNLOCK_15          0x00
                                          901
                                          902      #set      FLASH_B_UNLOCK_0           0x00
                                          903      #set      FLASH_B_UNLOCK_1           0x00
                                          904      #set      FLASH_B_UNLOCK_2           0x00
                                          905      #set      FLASH_B_UNLOCK_3           0x00
                                          906      #set      FLASH_B_UNLOCK_4           0x00
                                          907      #set      FLASH_B_UNLOCK_5           0x00
                                          908      #set      FLASH_B_UNLOCK_6           0x00
                                          909      #set      FLASH_B_UNLOCK_7           0x00
                                          910      #set      FLASH_B_UNLOCK_8           0x00
                                          911      #set      FLASH_B_UNLOCK_9           0x00
                                          912      #set      FLASH_B_UNLOCK_10          0x00
                                          913      #set      FLASH_B_UNLOCK_11          0x00
                                          914      #set      FLASH_B_UNLOCK_12          0x00
                                          915      #set      FLASH_B_UNLOCK_13          0x00
                                          916      #set      FLASH_B_UNLOCK_14          0x00
                                          917      #set      FLASH_B_UNLOCK_15          0x00
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  28
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          918
                                          919      #set      DATAFLASH_A_UNLOCK_0       0x00
                                          920      #set      DATAFLASH_A_UNLOCK_1       0x00
                                          921      #set      DATAFLASH_A_UNLOCK_2       0x00
                                          922      #set      DATAFLASH_A_UNLOCK_3       0x00
                                          923      #set      DATAFLASH_A_UNLOCK_4       0x00
                                          924      #set      DATAFLASH_A_UNLOCK_5       0x00
                                          925      #set      DATAFLASH_A_UNLOCK_6       0x00
                                          926      #set      DATAFLASH_A_UNLOCK_7       0x00
                                          927      #set      DATAFLASH_A_UNLOCK_8       0x00
                                          928      #set      DATAFLASH_A_UNLOCK_9       0x00
                                          929      #set      DATAFLASH_A_UNLOCK_10      0x00
                                          930      #set      DATAFLASH_A_UNLOCK_11      0x00
                                          931      #set      DATAFLASH_A_UNLOCK_12      0x00
                                          932      #set      DATAFLASH_A_UNLOCK_13      0x00
                                          933      #set      DATAFLASH_A_UNLOCK_14      0x00
                                          934      #set      DATAFLASH_A_UNLOCK_15      0x00
                                          935
                                          936      ;===============================================
                                                   =====================
                                          937      ; 4.13  Flash Write Protection
                                          938      ;===============================================
                                                   =====================
                                          939      ; All settings regarding sectors that do not exi
                                                   st on the particular
                                          940      ; device will have no effect.
                                          941
                                          942      #set      FLASH_A_WRITE_PROTECT           OFF
                                                       ; <<< select Flash A write protection
                                          943      #set      PROTECT_SECTOR_SA0              OFF
                                                       ; <<< select individual sector to protect
                                          944      #set      PROTECT_SECTOR_SA1              OFF
                                                       ; <<< select individual sector to protect
                                          945      #set      PROTECT_SECTOR_SA2              OFF
                                                       ; <<< select individual sector to protect
                                          946      #set      PROTECT_SECTOR_SA3              OFF
                                                       ; <<< select individual sector to protect
                                          947      #set      PROTECT_SECTOR_S32              OFF
                                                       ; <<< select individual sector to protect
                                          948      #set      PROTECT_SECTOR_S33              OFF
                                                       ; <<< select individual sector to protect
                                          949      #set      PROTECT_SECTOR_S34              OFF
                                                       ; <<< select individual sector to protect
                                          950      #set      PROTECT_SECTOR_S35              OFF
                                                       ; <<< select individual sector to protect
                                          951      #set      PROTECT_SECTOR_S36              OFF
                                                       ; <<< select individual sector to protect
                                          952      #set      PROTECT_SECTOR_S37              OFF
                                                       ; <<< select individual sector to protect
                                          953      #set      PROTECT_SECTOR_S38              OFF
                                                       ; <<< select individual sector to protect
                                          954      #set      PROTECT_SECTOR_S39              OFF
                                                       ; <<< select individual sector to protect
                                          955
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  29
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                          956      ; All settings regarding Flash B are ignored on
                                                   devices that do not
                                          957      ; have a Flash B.
                                          958      #set      FLASH_B_WRITE_PROTECT           OFF
                                                       ; <<< select Flash write protection
                                          959      #set      PROTECT_SECTOR_SB0              OFF
                                                       ; <<< select individual sector to protect
                                          960      #set      PROTECT_SECTOR_SB1              OFF
                                                       ; <<< select individual sector to protect
                                          961      #set      PROTECT_SECTOR_SB2              OFF
                                                       ; <<< select individual sector to protect
                                          962      #set      PROTECT_SECTOR_SB3              OFF
                                                       ; <<< select individual sector to protect
                                          963      #set      PROTECT_SECTOR_S28              OFF
                                                       ; <<< select individual sector to protect
                                          964      #set      PROTECT_SECTOR_S29              OFF
                                                       ; <<< select individual sector to protect
                                          965      #set      PROTECT_SECTOR_S30              OFF
                                                       ; <<< select individual sector to protect
                                          966      #set      PROTECT_SECTOR_S31              OFF
                                                       ; <<< select individual sector to protect
                                          967
                                          968      ; All settings regarding DataFlash A are ignored
                                                    on devices that do not
                                          969      ; have a DataFlash A.
                                          970      #set      FLASH_B_WRITE_PROTECT           OFF
                                                       ; <<< select Flash write protection
                                          971      #set      PROTECT_SECTOR_SB0              OFF
                                                       ; <<< select individual sector to protect
                                          972      #set      PROTECT_SECTOR_SB1              OFF
                                                       ; <<< select individual sector to protect
                                          973      #set      PROTECT_SECTOR_SB2              OFF
                                                       ; <<< select individual sector to protect
                                          974      #set      PROTECT_SECTOR_SB3              OFF
                                                       ; <<< select individual sector to protect
                                          975      #set      PROTECT_SECTOR_S28              OFF
                                                       ; <<< select individual sector to protect
                                          976      #set      PROTECT_SECTOR_S29              OFF
                                                       ; <<< select individual sector to protect
                                          977      #set      PROTECT_SECTOR_S30              OFF
                                                       ; <<< select individual sector to protect
                                          978      #set      PROTECT_SECTOR_S31              OFF
                                                       ; <<< select individual sector to protect
                                          979
                                          980
                                          981      ;===============================================
                                                   =====================
                                          982      ; 4.14  Boot Vector
                                          983      ;===============================================
                                                   =====================
                                          984
                                          985      #set      BOOT_VECTOR_TABLE  1              ; en
                                                   able boot vector
                                          986      #set      BOOT_VECTOR_FIXED  2              ; en
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  30
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   able boot vector
                                          987
                                          988      #set      BOOT_VECTOR   BOOT_VECTOR_TABLE   ; <<
                                                   < select type of boot vector
                                          989
                                          990      ; If boot vector generation is enabled (BOOT_VEC
                                                   TOR_TABLE, BOOT_VECTOR_FIXED),
                                          991      ; appropriate code is generated. If it is disabl
                                                   ed (OFF), start-up file does
                                          992      ; not care about.
                                          993      ;
                                          994      ;   BOOT_VECTOR_TABLE: - Create table entry at a
                                                   ddress oxFFFFDC.
                                          995      ;                      - Any start address can b
                                                   e set and start-up file will
                                          996      ;                        set address of this sta
                                                   rt code.
                                          997      ;   BOOT_VECTOR_FIXED: - Instead of table entry,
                                                    a special marker is set in
                                          998      ;                        ROM Configuration Block
                                                   , which enables the fixed
                                          999      ;                        start address 0xDF0080.
                                                    This is prefered setting
                                         1000      ;                        for user boot loaders.
                                         1001      ;                 OFF: - Do not set table entry
                                                   and marker. This might be used
                                         1002      ;                        for application to be l
                                                   oaded by boot loader.
                                         1003      ;
                                         1004      ; Note
                                         1005      ; BOOT_VECTOR_TABLE setting can also be used, if
                                                    all other interrupt vectors
                                         1006      ; are specified via "pragma intvect". Only if in
                                                   terrupts 0..7 are specified
                                         1007      ; via "pragma intvect", these will conflict with
                                                    the vector in this module.
                                         1008      ; The reason is the INTVECT section, which inclu
                                                   des the whole area from the
                                         1009      ; lowest to the highest specified vector.
                                         1010
                                         1011      ;===============================================
                                                   =====================
                                         1012      ; 4.15  UART scanning
                                         1013      ;===============================================
                                                   =====================
                                         1014
                                         1015      #set      UART_SCANNING   OFF        ; <<< enabl
                                                   e UART scanning in
                                         1016                                           ;     Inter
                                                   nal Vector Mode
                                         1017      ;
                                         1018      ; By default, the MCU scans in Internal Vector M
                                                   ode for a UART
                                         1019      ; communication after reset. This enables to est
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  31
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   ablish a serial
                                         1020      ; communication without switching to Serial Comm
                                                   unication Mode.
                                         1021      ; For the final application, set this switch to
                                                   OFF to achieve the
                                         1022      ; fastest start-up time.
                                         1023
                                         1024      ;===============================================
                                                   =====================
                                         1025      ; 4.16  Enable RAMCODE Copying
                                         1026      ;===============================================
                                                   =====================
                                         1027
                                         1028      #set      COPY_RAMCODE      OFF     ; <<< enable
                                                    RAMCODE section to
                                         1029                                          ; be copied
                                                   from ROM to RAM
                                         1030
                                         1031      ; To get this option properly working the code t
                                                   o be executed has to
                                         1032      ; be linked to section RAMCODE (e.g. by #pragma
                                                   section). The section
                                         1033      ; RAMCODE has be located in RAM and the section
                                                   @RAMCODE has to be
                                         1034      ; located at a fixed address in ROM by linker se
                                                   ttings.
                                         1035
                                         1036      ;===============================================
                                                   =====================
                                         1037      ; 4.17  Enable information stamp in ROM
                                         1038      ;===============================================
                                                   =====================
                                         1039
                                         1040      #set      VERSION_STAMP     OFF     ; <<< enable
                                                    version number in
                                         1041                                          ; separated
                                                   section
                                         1042
                                         1043      ;===============================================
                                                   =====================
                                         1044      ; 4.18  Enable Background Debugging Mode
                                         1045      ;===============================================
                                                   =====================
                                         1046
                                         1047      #set      BACKGROUND_DEBUGGING  ON ; <<< enable
                                                   Background Debugging
                                         1048                                          ; mode
                                         1049
                                         1050      #set      BDM_CONFIGURATION  B'0000000000010010
                                                    ; <<< set BDM configuration
                                         1051      ;                                    ||||||||++-
                                                   -- BdmUART
                                         1052      ;                                    ||||||||
                                                      (0: A, 1: B, 2: C, 3: D)
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  32
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1053      ;                                    ||||||++---
                                                   -- BdmSynchMode
                                         1054      ;                                    ||||||
                                                      (0: Async., 1: Sync.
                                         1055      ;                                    ||||||
                                                      2: BdmKLine, 3: res.)
                                         1056      ;                                    |||||+-----
                                                   -- BdmAutoStart
                                         1057      ;                                    ||||+------
                                                   -- BdmExtBreakpointCfg
                                         1058      ;                                    |||+-------
                                                   -- BdmKeepRClock
                                         1059      ;                                    ||+--------
                                                   -- BdmCaliRClock
                                         1060      ;                                    |+---------
                                                   -- BdmKeepBCD
                                         1061      ;                                    +----------
                                                   -- BdmUserKernel
                                         1062
                                         1063      #set      BDM_BAUDRATE    115200   ; <<< set Bau
                                                   drate in Bits/s for BDM
                                         1064
                                         1065      #set      BDM_EXT_CONFIG  0xFFFFFF ; <<< set ext
                                                   ernal Config/Kernel
                                         1066
                                         1067      #set      BDM_WD_PATTERN  0x00     ; <<< set wat
                                                   chdog pattern
                                         1068
                                         1069      #set      BDM_PFCS0       0x0000   ; <<< set def
                                                   ault breakpoint
                                         1070      #set      BDM_PFCS1       0x0000   ;     configu
                                                   rations
                                         1071      #set      BDM_PFCS2       0x0000
                                         1072      #set      BDM_PFCS3       0x0000
                                         1073
                                         1074      #set      BDM_PFA0        0xFFFFFF ; <<< set add
                                                   ress
                                         1075      #set      BDM_PFA1        0xFFFFFF ;     configu
                                                   rations
                                         1076      #set      BDM_PFA2        0xFFFFFF
                                         1077      #set      BDM_PFA3        0xFFFFFF
                                         1078      #set      BDM_PFA4        0xFFFFFF
                                         1079      #set      BDM_PFA5        0xFFFFFF
                                         1080      #set      BDM_PFA6        0xFFFFFF
                                         1081      #set      BDM_PFA7        0xFFFFFF
                                         1082
                                         1083      #set      BDM_PFD0        0xFFFF   ; <<< set pat
                                                   ch data
                                         1084      #set      BDM_PFD1        0xFFFF   ;     configu
                                                   rations
                                         1085      #set      BDM_PFD2        0xFFFF
                                         1086      #set      BDM_PFD3        0xFFFF
                                         1087      #set      BDM_PFD4        0xFFFF
                                         1088      #set      BDM_PFD5        0xFFFF
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  33
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1089      #set      BDM_PFD6        0xFFFF
                                         1090      #set      BDM_PFD7        0xFFFF
                                         1091
                                         1092
                                         1093      ; <<< END OF SETTINGS >>>
                                         1094
                                         1095      ;===============================================
                                                   =====================
                                         1096      ; 5  Section and Data Declaration
                                         1097      ;===============================================
                                                   =====================
                                         1098
                                         1099      ;===============================================
                                                   =====================
                                         1100      ; 5.1   Several fixed addresses (fixed for MB963
                                                   xx controllers)
                                         1101      ;===============================================
                                                   =====================
                                         1102
          = 000003F1                     1103      MCSRA      .EQU      0x03F1          ; Flash A M
                                                   emory configuration register
          = 000003F2                     1104      MTCRA      .EQU      0x03F2          ; Flash A M
                                                   emory timing register
          = 000003F5                     1105      MCSRB      .EQU      0x03F5          ; Flash B M
                                                   emory configuration register
          = 000003F6                     1106      MTCRB      .EQU      0x03F6          ; Flash B M
                                                   emory timing register
          = 000003AE                     1107      ROMM       .EQU      0x03AE          ; ROM mirro
                                                   r control register
          = 00000401                     1108      CKSR       .EQU      0x0401          ; Clock sel
                                                   ect control register
          = 00000402                     1109      CKSSR      .EQU      0x0402          ; Clock sta
                                                   bilization select register
          = 00000403                     1110      CKMR       .EQU      0x0403          ; Clock mon
                                                   itor register
          = 00000404                     1111      CKFCR      .EQU      0x0404          ; Clock fre
                                                   quency control register
          = 00000406                     1112      PLLCR      .EQU      0x0406          ; PLL contr
                                                   ol register
          = 0000042C                     1113      VRCR       .EQU      0x042C          ; Voltage R
                                                   egulator Control register
          = 00000041                     1114      ICE01      .EQU      0x0041          ; Input cap
                                                   ture 0/1 source
          = 00000053                     1115      ICE67      .EQU      0x0053          ; Input cap
                                                   ture 6/7 source
          = 00000515                     1116      ICE89      .EQU      0x0515          ; Input cap
                                                   ture 8/9 source
          = 0000051B                     1117      ICE1011    .EQU      0x051B          ; Input cap
                                                   ture 10/11 source
          = 00000514                     1118      ICS89      .EQU      0x0514          ; Input cap
                                                   ture 8/9 edge select
          = 0000051A                     1119      ICS1011    .EQU      0x051A          ; Input cap
                                                   ture 10/11 edge select
          = 00000502                     1120      TCCSL2     .EQU      0x0502          ; Free runn
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  34
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   ing timer 2 control/status register
          = 00000506                     1121      TCCSL3     .EQU      0x0506          ; Free runn
                                                   ing timer 3 control/status register
                                         1122      #if BUSMODE != SINGLE_CHIP           ; only for
                                                   devices with external bus
                                         1123   X  PIER00     .EQU      0x0444
                                         1124   X  PIER01     .EQU      0x0445
                                         1125   X  PIER02     .EQU      0x0446
                                         1126   X  PIER03     .EQU      0x0447
                                         1127   X  PIER12     .EQU      0x0450
                                         1128   X  EACL0      .EQU      0x06E0
                                         1129   X  EACH0      .EQU      0x06E1
                                         1130   X  EACL1      .EQU      0x06E2
                                         1131   X  EACH1      .EQU      0x06E3
                                         1132   X  EACL2      .EQU      0x06E4
                                         1133   X  EACH2      .EQU      0x06E5
                                         1134   X  EACL3      .EQU      0x06E6
                                         1135   X  EACH3      .EQU      0x06E7
                                         1136   X  EACL4      .EQU      0x06E8
                                         1137   X  EACH4      .EQU      0x06E9
                                         1138   X  EACL5      .EQU      0x06EA
                                         1139   X  EACH5      .EQU      0x06EB
                                         1140   X  EAS2       .EQU      0x06EC
                                         1141   X  EAS3       .EQU      0x06ED
                                         1142   X  EAS4       .EQU      0x06EE
                                         1143   X  EAS5       .EQU      0x06EF
                                         1144   X  EBM        .EQU      0x06F0
                                         1145   X  EBCF       .EQU      0x06F1
                                         1146   X  EBAE0      .EQU      0x06F2
                                         1147   X  EBAE1      .EQU      0x06F3
                                         1148   X  EBAE2      .EQU      0x06F4
                                         1149   X  EBCS       .EQU      0x06F5
                                         1150      #endif ; BUSMODE != SINGLE_CHIP
                                         1151
                                         1152      ;===============================================
                                                   =====================
                                         1153      ; 5.2   Set ROM Configuration for Boot Vector
                                         1154      ;===============================================
                                                   =====================
                                         1155
                                         1156      #if BOOT_VECTOR == BOOT_VECTOR_TABLE
RE FFFFDC ----------<RESVECT>----------  1157                .SECTION        RESVECT, CONST, LOCATE
                                                   =H'FFFFDC
RE FFFFDC 000000R                        1158                .DATA.E _start
RE FFFFDF 00                             1159                .DATA.B ((ADDRESSMODE << 7) | ((BUSMOD
                                                   E >> 1) << 6) | (CHIP_SELECT5 << 5) | (CHIP_SELE
                                                   CT4 << 4) | (CHIP_SELECT3 << 3) | (CHIP_SELECT2
                                                   << 2) | (CHIP_SELECT1 << 1) | CHIP_SELECT0)
                                         1160
BO DF0030 --------<BOOT_SELECT>--------  1161                .SECTION        BOOT_SELECT, CONST, LO
                                                   CATE=H'DF0030
BO DF0030 FFFFFFFF                       1162                .DATA.L 0xFFFFFFFF
                                         1163      #else
                                         1164   X  #  if BOOT_VECTOR == BOOT_VECTOR_FIXED
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  35
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1165   X            .SECTION        BOOT_SELECT, CONST, LO
                                                   CATE=H'DF0030
                                         1166   X            .DATA.L 0x292D3A7B        ; "Magic Wor
                                                   d"
                                         1167   X  #  else
                                         1168   X            .SECTION        BOOT_SELECT, CONST, LO
                                                   CATE=H'DF0030
                                         1169   X            .SKIP   4
                                         1170   X  #  endif
                                         1171      #endif
                                         1172
                                         1173      ;===============================================
                                                   =====================
                                         1174      ; 5.3   Set ROM configuration for UART Scanning
                                         1175      ;===============================================
                                                   =====================
                                         1176
                                         1177      #if UART_SCANNING == ON
                                         1178   X  #  if ((SERIES == MB96340) && (DEVICE < 3))
                                         1179   X  #    error Device does not support UART scanning
                                                    on/off
                                         1180   X  #  else
                                         1181   X            .SECTION        UART_SCAN_SELECT, CONS
                                                   T, LOCATE=H'DF0034
                                         1182   X            .DATA.L 0xFFFFFFFF
                                         1183   X  #  endif ; (SERIES == MB96340 && DEVICE < 3)
                                         1184      #else
UA DF0034 -----<UART_SCAN_SELECT>------  1185                .SECTION        UART_SCAN_SELECT, CONS
                                                   T, LOCATE=H'DF0034
UA DF0034 7B3A2D29                       1186                .DATA.L 0x292D3A7B        ; Decativati
                                                   on "Magic Word"
                                         1187      #endif
UA DF0040 - DF0038   [8]                 1188                .SKIP   0x08
                                         1189
                                         1190      ;===============================================
                                                   =====================
                                         1191      ; 5.4   Store version information
                                         1192      ;===============================================
                                                   =====================
                                         1193
                                         1194      #if VERSION_STAMP == ON
                                         1195   X            .SECTION  VERSIONS, CONST ; change nam
                                                   e, if necessary
                                         1196   X            .SDATA    "Start ", VERSION, "\n\0"
                                         1197      #endif
                                         1198
                                         1199      ;===============================================
                                                   =====================
                                         1200      ; 5.5   Declaration of __near addressed data sec
                                                   tions
                                         1201      ;===============================================
                                                   =====================
                                         1202
                                         1203      ; sections to be cleared
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  36
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

DA 000000 -----------<DATA>------------  1204                .SECTION  DATA,      DATA,   ALIGN=2
                                                   ; zero clear area
DA 000000 -----------<DATA2>-----------  1205                .SECTION  DATA2,     DATA,   ALIGN=2
                                                   ; zero clear area
DI 000000 ----------<DIRDATA>----------  1206                .SECTION  DIRDATA,   DIR,    ALIGN=2
                                                   ; zero clear direct
LI 000000 ----------<LIBDATA>----------  1207                .SECTION  LIBDATA,   DATA,   ALIGN=2
                                                   ; zero clear lib area
                                         1208
                                         1209      ; sections to be initialised with start-up value
                                                   s
IN 000000 -----------<INIT>------------  1210                .SECTION  INIT,      DATA,   ALIGN=2
                                                   ; initialised area
IN 000000 -----------<INIT2>-----------  1211                .SECTION  INIT2,     DATA,   ALIGN=2
                                                   ; initialised area
DI 000000 ----------<DIRINIT>----------  1212                .SECTION  DIRINIT,   DIR,    ALIGN=2
                                                   ; initialised dir
LI 000000 ----------<LIBINIT>----------  1213                .SECTION  LIBINIT,   DATA,   ALIGN=2
                                                   ; initialised lib area
                                         1214      #if CONSTDATA == RAMCONST
CI 000000 -----------<CINIT>-----------  1215                .SECTION  CINIT,     DATA,   ALIGN=2
                                                   ; initialised const
CI 000000 ----------<CINIT2>-----------  1216                .SECTION  CINIT2,    DATA,   ALIGN=2
                                                   ; initialised const
                                         1217      #endif
                                         1218
                                         1219      ; sections containing start-up values for initia
                                                   lised sections above
DC 000000 ----------<DCONST>-----------  1220                .SECTION  DCONST,    CONST,  ALIGN=2
                                                   ; DINIT initialisers
DI 000000 ---------<DIRCONST>----------  1221                .SECTION  DIRCONST, DIRCONST,ALIGN=2
                                                   ; DIRINIT initialisers
LI 000000 ---------<LIBDCONST>---------  1222                .SECTION  LIBDCONST, CONST,  ALIGN=2
                                                   ; LIBDCONST init val
                                         1223
                                         1224                ; following section is either copied t
                                                   o CINIT (RAMCONST) or
                                         1225                ; mapped by ROM-mirror function (ROMCO
                                                   NST)
CO 000000 -----------<CONST>-----------  1226                .SECTION  CONST,     CONST,  ALIGN=2
                                                   ; CINIT initialisers
CO 000000 ----------<CONST2>-----------  1227                .SECTION  CONST2,    CONST,  ALIGN=2
                                                   ; CINIT initialisers
                                         1228
                                         1229      ;===============================================
                                                   =====================
                                         1230      ; 5.6   Declaration of RAMCODE section and label
                                                   s
                                         1231      ;===============================================
                                                   =====================
                                         1232
                                         1233      #if COPY_RAMCODE == ON
                                         1234   X            .SECTION  RAMCODE,   CODE,  ALIGN=1
                                         1235   X            .IMPORT _RAM_RAMCODE
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  37
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   ; provided by linker
                                         1236   X            .IMPORT _ROM_RAMCODE
                                                   ; provided by linker
                                         1237      #endif
                                         1238
                                         1239
                                         1240      ;===============================================
                                                   =====================
                                         1241      ; 5.7   Declaration of sections containing other
                                                    sections description
                                         1242      ;===============================================
                                                   =====================
                                         1243
                                         1244      ; DCLEAR contains start address and size of all
                                                   sections to be cleared
                                         1245      ; DTRANS contains source and destination address
                                                    and size of all
                                         1246      ; sections to be initialised with start-up value
                                                   s
                                         1247      ; The compiler automatically adds a descriptor f
                                                   or each __far addressed
                                         1248      ; data section to DCLEAR or DTRANS. These __far
                                                   sections are separated
                                         1249      ; for each C-module.
                                         1250
                                         1251      ; In addition the start-up file adds the descrip
                                                   tors of the previously
                                         1252      ; declared __near section here. This way the sam
                                                   e code in the start-up
                                         1253      ; file can be used for initialising all sections
                                                   .
                                         1254
DC 000000 ----------<DCLEAR>-----------  1255         .SECTION  DCLEAR,    CONST,  ALIGN=2  ; zero
                                                   clear table
                                         1256         ;    Address         Bank            Size
DC 000000 0000S 0000S 0000S              1257         .DATA.H DATA,    BNKSEC DATA,    SIZEOF(DATA
                                                     )
DC 000006 0000S 0000S 0000S              1258         .DATA.H DIRDATA, BNKSEC DIRDATA, SIZEOF(DIRDA
                                                   TA)
DC 00000C 0000S 0000S 0000S              1259         .DATA.H LIBDATA, BNKSEC LIBDATA, SIZEOF(LIBDA
                                                   TA)
                                         1260
DT 000000 ----------<DTRANS>-----------  1261         .SECTION  DTRANS,    CONST,  ALIGN=2  ; copy
                                                   table
                                         1262         ;    Address         Bank               Addre
                                                   ss     Bank          Size
DT 000000 0000S 0000S 0000S 0000S 0000S  1263         .DATA.H DCONST,   BNKSEC DCONST,   INIT,   BN
                                                   KSEC INIT,   SIZEOF INIT
DT 00000A 0000S 0000S 0000S 0000S 0000S  1264         .DATA.H DIRCONST, BNKSEC DIRCONST, DIRINIT,BN
                                                   KSEC DIRINIT,SIZEOF DIRINIT
DT 000014 0000S 0000S 0000S 0000S 0000S  1265         .DATA.H LIBDCONST,BNKSEC LIBDCONST,LIBINIT,BN
                                                   KSEC LIBINIT,SIZEOF LIBINIT
                                         1266
                                         1267      #if CONSTDATA == RAMCONST
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  38
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

DT 00001E 0000S 0000S 0000S 0000S 0000S  1268         .DATA.H CONST,    BNKSEC CONST,    CINIT,  BN
                                                   KSEC CINIT,  SIZEOF CINIT
DT 000028 0000S 0000S 0000S 0000S 0000S  1269         .DATA.H CONST2,   BNKSEC CONST,    CINIT2, BN
                                                   KSEC CINIT2, SIZEOF CINIT2
                                         1270      #endif
                                         1271
                                         1272      #if COPY_RAMCODE == ON
                                         1273   X     .DATA.L _ROM_RAMCODE, _RAM_RAMCODE
                                         1274   X     .DATA.H SIZEOF RAMCODE
                                         1275      #endif
                                         1276
                                         1277      ;===============================================
                                                   =====================
                                         1278      ; 5.8   Stack area and stack top definition/decl
                                                   aration
                                         1279      ;===============================================
                                                   =====================
                                         1280      #if STACK_RESERVE == ON
SS 000000 ----------<SSTACK>-----------  1281                  .SECTION  SSTACK, STACK, ALIGN=2
                                         1282
                                         1283                  .EXPORT __systemstack, __systemstack
                                                   _top
SS 000000                                1284      __systemstack:
SS 000000 [768]B                         1285                  .RES.B    (STACK_SYS_SIZE + 1) & 0xF
                                                   FFE
SS 000300                                1286      __systemstack_top:
SS 000300                                1287      SSTACK_TOP:
                                         1288
US 000000 ----------<USTACK>-----------  1289                  .SECTION  USTACK, STACK, ALIGN=2
                                         1290
                                         1291                  .EXPORT __userstack, __userstack_top
US 000000                                1292      __userstack:
US 000000 [2]B                           1293                  .RES.B    (STACK_USR_SIZE + 1) & 0xF
                                                   FFE
US 000002                                1294      __userstack_top:
US 000002                                1295      USTACK_TOP:
                                         1296
                                         1297      #else
                                         1298   X              .SECTION  SSTACK, STACK, ALIGN=2
                                         1299   X              .SECTION  USTACK, STACK, ALIGN=2
                                         1300      #endif
                                         1301
                                         1302      ;===============================================
                                                   =====================
                                         1303      ; 5.9   Direct page register dummy label definit
                                                   ion
                                         1304      ;===============================================
                                                   =====================
                                         1305
DI 000000 ----------<DIRDATA>----------  1306                .SECTION  DIRDATA  ; zero clear direct
DI 000000                                1307      DIRDATA_S:
                                                   ; label for DPR init
                                         1308
                                         1309      ; This label is used to get the page of the __di
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  39
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   rect data.
                                         1310      ; Depending on the linkage order of this startup
                                                    file the label is
                                         1311      ; placed anywhere within the __direct data page.
                                                    However, the
                                         1312      ; statement "PAGE (DIRDATA_S)" is processed. The
                                                   refore, the lower
                                         1313      ; 8 Bit of the address of DIRDATA_S are not rele
                                                   vant and this feature
                                         1314      ; becomes linkage order independent.
                                         1315      ; Note, the linker settings have to make sure th
                                                   at all __direct
                                         1316      ; data are located within the same physical page
                                                    (256 Byte block).
                                         1317
                                         1318      ;===============================================
                                                   =====================
                                         1319      ; 5.10  Set Flash Security
                                         1320      ;===============================================
                                                   =====================
                                         1321
                                         1322      #set FLASH_B_AVAILABLE
                                                                 \
                                         1323        (
                                                                 \
                                         1324          (
                                                                 \
                                         1325            (SERIES == MB96340) &&
                                                                 \
                                         1326            (
                                                                 \
                                         1327              (DEVICE == MB96348HxA) ||
                                                                 \
                                         1328              (DEVICE == MB96348TxA) ||
                                                                 \
                                         1329              (DEVICE == MB96348CxA) ||
                                                                 \
                                         1330              (DEVICE == MB96348HxB) ||
                                                                 \
                                         1331              (DEVICE == MB96348TxB) ||
                                                                 \
                                         1332              (DEVICE == MB96348HxC) ||
                                                                 \
                                         1333              (DEVICE == MB96348TxC) ||
                                                                 \
                                         1334              (DEVICE == MB96348CxC)
                                                                 \
                                         1335            )
                                                                 \
                                         1336          )
                                                                 \
                                         1337          ||
                                                                 \
                                         1338          (SERIES == MB96370)
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  40
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                                 \
                                         1339          ||
                                                                 \
                                         1340          (
                                                                 \
                                         1341            (SERIES == MB96380) &&
                                                                 \
                                         1342            (
                                                                 \
                                         1343              (DEVICE == MB96388HxB) ||
                                                                 \
                                         1344              (DEVICE == MB96389RxB)
                                                                 \
                                         1345            )
                                                                 \
                                         1346          )
                                                                 \
                                         1347        )
                                         1348
                                         1349      #set DATAFLASH_A_AVAILABLE
                                                                 \
                                         1350        (
                                                                 \
                                         1351          (
                                                                 \
                                         1352            (SERIES == MB96910) &&
                                                                 \
                                         1353            (
                                                                 \
                                         1354              (DEVICE == MB96918DxA)
                                                                 \
                                         1355            )
                                                                 \
                                         1356          )
                                                                 \
                                         1357          ||
                                                                 \
                                         1358          (
                                                                 \
                                         1359            (SERIES == MB96340) &&
                                                                 \
                                         1360            (
                                                                 \
                                         1361              (DEVICE == MB96345DxA)
                                                                 \
                                         1362            )
                                                                 \
                                         1363          )
                                                                 \
                                         1364        )
                                         1365
FL DF0000 -----<FLASH_A_SECURITY>------  1366                .SECTION FLASH_A_SECURITY, CONST, LOCA
                                                   TE=H'DF0000
                                         1367      #if FLASH_A_SECURITY_ENABLE == 0
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  41
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

FL DF0000 6600                           1368                    .DATA.W 0x0066 ; Security DISABLED
                                                    (mandatory for mask ROM)
FL DF0012 - DF0002   [16]                1369                    .SKIP   16
                                         1370      #else FLASH_A_SECURITY_ENABLE == 1
                                         1371   X                .DATA.W 0x0099 ; Security ENABLED
                                         1372   X                .DATA.W ((FLASH_A_UNLOCK_1  << 8)
                                                   | FLASH_A_UNLOCK_0)
                                         1373   X                .DATA.W ((FLASH_A_UNLOCK_3  << 8)
                                                   | FLASH_A_UNLOCK_2)
                                         1374   X                .DATA.W ((FLASH_A_UNLOCK_5  << 8)
                                                   | FLASH_A_UNLOCK_4)
                                         1375   X                .DATA.W ((FLASH_A_UNLOCK_7  << 8)
                                                   | FLASH_A_UNLOCK_6)
                                         1376   X                .DATA.W ((FLASH_A_UNLOCK_9  << 8)
                                                   | FLASH_A_UNLOCK_8)
                                         1377   X                .DATA.W ((FLASH_A_UNLOCK_11 << 8)
                                                   | FLASH_A_UNLOCK_10)
                                         1378   X                .DATA.W ((FLASH_A_UNLOCK_13 << 8)
                                                   | FLASH_A_UNLOCK_12)
                                         1379   X                .DATA.W ((FLASH_A_UNLOCK_15 << 8)
                                                   | FLASH_A_UNLOCK_14)
                                         1380      #endif
FL DF0016 - DF0012   [4]                 1381                    .SKIP   4
FL DF001C - DF0016   [6]                 1382                    .SKIP   6
                                         1383
                                         1384      #if FLASH_B_AVAILABLE == ON
                                         1385   X            .SECTION FLASH_B_SECURITY, CONST, LOCA
                                                   TE=H'DE0000
                                         1386   X  #  if FLASH_B_SECURITY_ENABLE == 0
                                         1387   X                .DATA.W 0x0066 ; Security DISABLED
                                                    (mandatory for mask ROM)
                                         1388   X                .SKIP   16
                                         1389   X  #  else FLASH_B_SECURITY_ENABLE == 1
                                         1390   X                .DATA.W 0x0099 ; Security ENABLED
                                         1391   X                .DATA.W ((FLASH_B_UNLOCK_1  << 8)
                                                   | FLASH_B_UNLOCK_0)
                                         1392   X                .DATA.W ((FLASH_B_UNLOCK_3  << 8)
                                                   | FLASH_B_UNLOCK_2)
                                         1393   X                .DATA.W ((FLASH_B_UNLOCK_5  << 8)
                                                   | FLASH_B_UNLOCK_4)
                                         1394   X                .DATA.W ((FLASH_B_UNLOCK_7  << 8)
                                                   | FLASH_B_UNLOCK_6)
                                         1395   X                .DATA.W ((FLASH_B_UNLOCK_9  << 8)
                                                   | FLASH_B_UNLOCK_8)
                                         1396   X                .DATA.W ((FLASH_B_UNLOCK_11 << 8)
                                                   | FLASH_B_UNLOCK_10)
                                         1397   X                .DATA.W ((FLASH_B_UNLOCK_13 << 8)
                                                   | FLASH_B_UNLOCK_12)
                                         1398   X                .DATA.W ((FLASH_B_UNLOCK_15 << 8)
                                                   | FLASH_B_UNLOCK_14)
                                         1399   X  #  endif
                                         1400   X                .SKIP   4
                                         1401   X                .SKIP   6
                                         1402      #endif ; FLASH_B_AVAILABLE == ON
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  42
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1403
                                         1404      #if DATAFLASH_A_AVAILABLE == ON
                                         1405   X            .SECTION DATAFLASH_A_SECURITY, CONST,
                                                   LOCATE=H'0EFF00
                                         1406   X  #  if DATAFLASH_A_SECURITY_ENABLE == 0
                                         1407   X                .DATA.W 0x0066 ; Security DISABLED
                                                    (mandatory for mask ROM)
                                         1408   X                .SKIP   16
                                         1409   X  #  else DATAFLASH_A_SECURITY_ENABLE == 1
                                         1410   X                .DATA.W 0x0099 ; Security ENABLED
                                         1411   X                .DATA.W ((DATAFLASH_A_UNLOCK_1  <<
                                                    8) | DATAFLASH_A_UNLOCK_0)
                                         1412   X                .DATA.W ((DATAFLASH_A_UNLOCK_3  <<
                                                    8) | DATAFLASH_A_UNLOCK_2)
                                         1413   X                .DATA.W ((DATAFLASH_A_UNLOCK_5  <<
                                                    8) | DATAFLASH_A_UNLOCK_4)
                                         1414   X                .DATA.W ((DATAFLASH_A_UNLOCK_7  <<
                                                    8) | DATAFLASH_A_UNLOCK_6)
                                         1415   X                .DATA.W ((DATAFLASH_A_UNLOCK_9  <<
                                                    8) | DATAFLASH_A_UNLOCK_8)
                                         1416   X                .DATA.W ((DATAFLASH_A_UNLOCK_11 <<
                                                    8) | DATAFLASH_A_UNLOCK_10)
                                         1417   X                .DATA.W ((DATAFLASH_A_UNLOCK_13 <<
                                                    8) | DATAFLASH_A_UNLOCK_12)
                                         1418   X                .DATA.W ((DATAFLASH_A_UNLOCK_15 <<
                                                    8) | DATAFLASH_A_UNLOCK_14)
                                         1419   X  #  endif
                                         1420   X                .SKIP   4
                                         1421   X                .SKIP   6
                                         1422      #endif ; DATAFLASH_A_AVAILABLE == ON
                                         1423
                                         1424
                                         1425      ;===============================================
                                                   =====================
                                         1426      ; 5.11  Set Flash write protection
                                         1427      ;===============================================
                                                   =====================
                                         1428
FL DF001C ------<FLASH_A_PROTECT>------  1429                .SECTION FLASH_A_PROTECT, CONST, LOCAT
                                                   E=H'DF001C
                                         1430      #if FLASH_A_WRITE_PROTECT == ON
                                         1431   X            .DATA.L 0x292D3A7B
                                         1432   X            .DATA.B ~((PROTECT_SECTOR_SA3 << 3) |
                                                   (PROTECT_SECTOR_SA2 << 2) | (PROTECT_SECTOR_SA1
                                                   << 1) | PROTECT_SECTOR_SA0)
                                         1433   X            .DATA.H 0x0000
                                         1434   X            .DATA.B ~((PROTECT_SECTOR_S31 << 7) |
                                                   (PROTECT_SECTOR_S30 << 6) | (PROTECT_SECTOR_S29
                                                   << 5) | (PROTECT_SECTOR_S28 << 4))
                                         1435   X            .DATA.B ~((PROTECT_SECTOR_S39 << 7) |
                                                   (PROTECT_SECTOR_S38 << 6) | (PROTECT_SECTOR_S37
                                                   << 5) | (PROTECT_SECTOR_S36 << 4) | (PROTECT_SEC
                                                   TOR_S35 << 3) | (PROTECT_SECTOR_S34 << 2) | (PRO
                                                   TECT_SECTOR_S33 << 1) | PROTECT_SECTOR_S32)
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  43
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1436   X            .SKIP   3
                                         1437      #else
FL DF001C FFFFFFFF                       1438                .DATA.L 0xFFFFFFFF
FL DF0028 - DF0020   [8]                 1439                .SKIP   8
                                         1440      #endif ; FLASH_A_WRITE_PROTECT
FL DF0030 - DF0028   [8]                 1441                .SKIP   8
                                         1442
                                         1443      #if FLASH_B_AVAILABLE == ON
                                         1444   X            .SECTION FLASH_B_PROTECT, CONST, LOCAT
                                                   E=H'DE001C
                                         1445   X  #  if FLASH_B_WRITE_PROTECT == ON
                                         1446   X            .DATA.L 0x292D3A7B
                                         1447   X            .DATA.B ~((PROTECT_SECTOR_SB3 << 3) |
                                                   (PROTECT_SECTOR_SB2 << 2) | (PROTECT_SECTOR_SB1
                                                   << 1) | PROTECT_SECTOR_SB0)
                                         1448   X            .DATA.H 0x0000
                                         1449   X            .DATA.B ~((PROTECT_SECTOR_S31 << 7) |
                                                   (PROTECT_SECTOR_S30 << 6) | (PROTECT_SECTOR_S29
                                                   << 5) | (PROTECT_SECTOR_S28 << 4))
                                         1450   X            .DATA.B ~((PROTECT_SECTOR_S39 << 7) |
                                                   (PROTECT_SECTOR_S38 << 6) | (PROTECT_SECTOR_S37
                                                   << 5) | (PROTECT_SECTOR_S36 << 4) | (PROTECT_SEC
                                                   TOR_S35 << 3) | (PROTECT_SECTOR_S34 << 2) | (PRO
                                                   TECT_SECTOR_S33 << 1) | PROTECT_SECTOR_S32)
                                         1451   X            .SKIP   3
                                         1452   X  #  else
                                         1453   X            .DATA.L 0xFFFFFFFF
                                         1454   X            .SKIP   8
                                         1455   X  #  endif ; FLASH_B_WRITE_PROTECT
                                         1456   X            .SKIP   8
                                         1457      #endif ; FLASH_B_AVAILABLE == ON
                                         1458
                                         1459      ;===============================================
                                                   =====================
                                         1460      ; 5.12  Debug address specification
                                         1461      ;===============================================
                                                   =====================
                                         1462      ;
                                         1463      ; BDM configuration section should always be def
                                                   ined for later
                                         1464      ; configuration by e.g. debugger tool or (specia
                                                   l) programmer tool.
                                         1465
BD DF0040 --------<BDM_CONFIG>---------  1466                .SECTION BDM_CONFIG, CONST, LOCATE=H'D
                                                   F0040
                                         1467
                                         1468      #if BACKGROUND_DEBUGGING == ON
                                         1469
BD DF0040 7B3A2D29                       1470                .DATA.L 0x292D3A7B
                                         1471
BD DF0044                                1472                .ORG    H'DF0044
BD DF0044 1200                           1473                .DATA.W BDM_CONFIGURATION
                                         1474
BD DF0046                                1475                .ORG    H'DF0046
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  44
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1476      #  if ((SERIES == MB96340) && (DEVICE < 3))
                                         1477   X  #    error Device does not support background de
                                                   bugging
                                         1478      #  endif ; ((SERIES == MB96340) && (DEVICE < 3))
                                         1479
                                         1480      #  if ((SERIES == MB96340) && (DEVICE < 12))
                                         1481   X            .DATA.W (D'16 * CRYSTAL + BDM_BAUDRATE
                                                   ) / BDM_BAUDRATE
                                         1482      #  else
BD DF0046 AF08                           1483                .DATA.W (D'32 * CRYSTAL + BDM_BAUDRATE
                                                   ) / BDM_BAUDRATE
                                         1484      #  endif ; ((SERIES == MB96340) && (DEVICE < 12)
                                                   )
                                         1485
BD DF0048                                1486                .ORG    H'DF0048
BD DF0048 FFFFFF                         1487                .DATA.E BDM_EXT_CONFIG
                                         1488
BD DF004B                                1489                .ORG    H'DF004B
BD DF004B 00                             1490                .DATA.B BDM_WD_PATTERN
                                         1491
BD DF0050                                1492                .ORG    H'DF0050
BD DF0050 0000                           1493                .DATA.W BDM_PFCS0
BD DF0052 0000                           1494                .DATA.W BDM_PFCS1
BD DF0054 0000                           1495                .DATA.W BDM_PFCS2
BD DF0056 0000                           1496                .DATA.W BDM_PFCS3
                                         1497
BD DF0058 FFFFFF  FFFFFF                 1498                .DATA.E BDM_PFA0, BDM_PFA1
BD DF005E FFFFFF  FFFFFF                 1499                .DATA.E BDM_PFA2, BDM_PFA3
BD DF0064 FFFFFF  FFFFFF                 1500                .DATA.E BDM_PFA4, BDM_PFA5
BD DF006A FFFFFF  FFFFFF                 1501                .DATA.E BDM_PFA6, BDM_PFA7
                                         1502
BD DF0070 FFFF  FFFF                     1503                .DATA.W BDM_PFD0, BDM_PFD1
BD DF0074 FFFF  FFFF                     1504                .DATA.W BDM_PFD2, BDM_PFD3
BD DF0078 FFFF  FFFF                     1505                .DATA.W BDM_PFD4, BDM_PFD5
BD DF007C FFFF  FFFF                     1506                .DATA.W BDM_PFD6, BDM_PFD7
                                         1507      #else
                                         1508   X            .DATAB.B 64, 0xFF        ; fill sectio
                                                   n with 0xFF
                                         1509   X
                                         1510      #endif ; BACKGROUND_DEBUGGING == ON
                                         1511
BD DF0080                                1512                .ORG    0xDF0080
                                         1513
                                         1514      ;===============================================
                                                   =====================
                                         1515      ; 6  Start-Up Code
                                         1516      ;===============================================
                                                   =====================
                                         1517
                                         1518      ;===============================================
                                                   =====================
                                         1519      ; 6.1   Import external symbols
                                         1520      ;===============================================
                                                   =====================
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  45
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1521
                                         1522                .IMPORT   _main                    ; u
                                                   ser code entrance
                                         1523      #if CLIBINIT == ON
                                         1524   X            .IMPORT   __stream_init
                                         1525   X            .IMPORT   _exit
                                         1526   X            .EXPORT   __exit
                                         1527      #endif
                                         1528                .EXPORT   _start
                                         1529
                                         1530      ;===============================================
                                                   =====================
                                         1531      ;   ___  _____   __    ___  _____
                                         1532      ;  /       |    /  \  |   \   |
                                         1533      ;  \___    |   |    | |___/   |
                                         1534      ;      \   |   |----| |  \    |
                                         1535      ;   ___/   |   |    | |   \   |      Begin of ac
                                                   tual code section
                                         1536      ;
                                         1537      ;===============================================
                                                   =====================
CO 000000 --------<CODE_START>---------  1538                .SECTION  CODE_START, CODE, ALIGN=1
                                         1539
                                         1540      ;===============================================
                                                   =====================
                                         1541      ; 6.2   Program start (the reset vector should p
                                                   oint here)
                                         1542      ;===============================================
                                                   =====================
CO 000000                                1543      _start:
CO 000000 00                             1544                NOP  ; This NOP is only for debugging.
                                                    On debugger the IP
                                         1545                     ; (instruction pointer) should po
                                                   int here after reset
                                         1546
                                         1547      ;===============================================
                                                   =====================
                                         1548      ; 6.3   "NOT RESET YET" WARNING
                                         1549      ;===============================================
                                                   =====================
CO 000001                                1550      notresetyet:
CO 000001 00                             1551                NOP  ; read hint below!!!!!!!
                                         1552      ; If the debugger stays at this NOP after downlo
                                                   ad, the controller has
                                         1553      ; not been reset yet. In order to reset all hard
                                                   ware registers it is
                                         1554      ; highly recommended to reset the controller.
                                         1555      ; However, if no reset vector has been defined o
                                                   n purpose, this start
                                         1556      ; address can also be used.
                                         1557      ; This mechanism is using the .END instruction a
                                                   t the end of this mo-
                                         1558      ; dule. It is not necessary for controller opera
                                                   tion but improves
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  46
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1559      ; security during debugging (mainly emulator deb
                                                   ugger).
                                         1560      ; If the debugger stays here after a single step
                                                    from label "_start"
                                         1561      ; to label "notresetyet", this note can be ignor
                                                   ed.
                                         1562
                                         1563      ;===============================================
                                                   =====================
                                         1564      ; 6.4   Initialisation of processor status
                                         1565      ;===============================================
                                                   =====================
CO 000002 2480                           1566                AND  CCR, #0x80          ; disable int
                                                   errupts
CO 000004 1A07                           1567                MOV  ILM,#7              ; set interru
                                                   pt level mask to ALL
CO 000006 0A00                           1568                MOV  RP,#REGBANK         ; set registe
                                                   r bank pointer
                                         1569
                                         1570      ;===============================================
                                                   =====================
                                         1571      ; 6.5   Set clock ratio (ignore subclock)
                                         1572      ;===============================================
                                                   =====================
                                         1573
CO 000008 D0                             1574                MOVN A, #0               ; set bank 0
                                                   in DTB for the case that
CO 000009 6F10                           1575                MOV  DTB, A              ; start-up co
                                                   de was not jumped by reset
                                         1576
CO 00000B 71DF0204FC                     1577                MOV  CKSSR, #(0xF8 | MC_STAB_TIME)  ;
                                                   set clock stabilization time
                                         1578
                                         1579      #set CLOCK_RC     0     ; RC clock is input to c
                                                   lock divider
                                         1580      #set CLOCK_MAIN   1     ; MAIN clock is input to
                                                    clock divider
                                         1581      #set CLOCK_PLL    2     ; PLL clock is input to
                                                   clock divider
                                         1582      #set CLOCK_SUB    3     ; SUB clock is input to
                                                   clock divider
                                         1583
                                         1584      ; select default source for CLKB and CLKP1
                                         1585      #set CLKB_CLKP1_SOURCE  CLOCK_PLL
                                         1586      ; select default source for CLKP2 and CLKP3
                                         1587      #set CLKP2_CLKP3_SOURCE CLOCK_PLL
                                         1588
                                         1589      ;                                  ++------    P
                                                   LL multiplier (CLKS1, CLKS2)
                                         1590      ;                                  ||+-----    C
                                                   LKB divider (CPU clock)
                                         1591      ;                                  |||+----    C
                                                   LKP1 divider (peripherals except CAN, Sound, USB
                                                   )
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  47
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1592      ;                                  ||||+---    C
                                                   LKP2 divider (CAN, Sound)
                                         1593      ;                                  |||||+--    C
                                                   LKP3 divider (USB if available)
                                         1594      ;                                  ||||||+-    V
                                                   CO clock multiplier (PPG internal)
                                         1595      ;                                  |||||||
                                         1596      #if CLOCK_SPEED == CPU_4MHZ_MAIN_CLKP2_4MHZ
                                         1597   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x011111E   ; C
                                                   LKS1=CLKS2= 4MHZ, CLK_VCO= 56MHZ
                                         1598   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x011111E   ; C
                                                   LKS1=CLKS2= 4MHZ, CLK_VCO= 56MHZ
                                         1599   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x012222E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1600   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x012222E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1601   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x014444C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1602   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x014444C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1603   X  #  set CLKB_CLKP1_SOURCE  CLOCK_MAIN         ; s
                                                   elect MAIN clock as source for CLKB, CLKP1 divid
                                                   er
                                         1604   X  #  set CLKP2_CLKP3_SOURCE CLOCK_MAIN         ; s
                                                   elect MAIN clock as source for CLKP2, CLKP3 divi
                                                   der
                                         1605      #elif CLOCK_SPEED == CPU_48MHZ_CLKP1_16MHZ_CLKP2
                                                   _CLKP3_MAIN
                                         1606   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0C13114   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1607   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1826112   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1608   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0613114   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1609   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0C26112   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1610   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0313114   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1611   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0626112   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1612   X  #  set CLKP2_CLKP3_SOURCE CLOCK_MAIN         ; s
                                                   elect MAIN clock as source for CLKP2, CLKP3 divi
                                                   der
                                         1613   X
                                         1614      #elif CLOCK_SPEED == CPU_4MHZ_PLL_CLKP2_4MHZ
                                         1615   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x011111E   ; C
                                                   LKS1=CLKS2= 4MHZ, CLK_VCO= 56MHZ
                                         1616   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x022222E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1617   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x012222E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1618   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x012222E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1619   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x014444C   ; C
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  48
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1620   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x014444C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1621      #elif CLOCK_SPEED == CPU_8MHZ_CLKP2_8MHZ
                                         1622      #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x021111E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1623      #  set   CLK_PARAMS_4MHZ_CLKB2   0x042222C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1624      #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x011111E   ; C
                                                   LKS1=CLKS2= 8MHZ, CLK_VCO=112MHZ
                                         1625      #  set   CLK_PARAMS_8MHZ_CLKB2   0x022222C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1626      #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x012222C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1627      #  set  CLK_PARAMS_16MHZ_CLKB2   0x012222C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1628      #elif CLOCK_SPEED == CPU_12MHZ_CLKP2_12MHZ
                                         1629   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x031111E   ; C
                                                   LKS1=CLKS2=12MHZ, CLK_VCO=168MHZ
                                         1630   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0622228   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1631   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0322228   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1632   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0322228   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1633   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0344444   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1634   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0344444   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1635   X  #elif CLOCK_SPEED == CPU_16MHZ_CLKP2_16MHZ
                                         1636   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x041111C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1637   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0822226   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1638   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x021111C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1639   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0422226   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1640   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x011111C   ; C
                                                   LKS1=CLKS2=16MHZ, CLK_VCO=192MHZ
                                         1641   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0222226   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1642   X  #elif CLOCK_SPEED == CPU_24MHZ_CLKP2_12MHZ
                                         1643   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0611218   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1644   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0C22424   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1645   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0311218   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1646   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0622424   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1647   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0322424   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1648   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0322424   ; C
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  49
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1649   X  #elif CLOCK_SPEED == CPU_24MHZ_CLKP2_16MHZ
                                         1650   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0C22324   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1651   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0C22324   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1652   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0622324   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1653   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0622324   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1654   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0322324   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1655   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0322324   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1656   X  #elif CLOCK_SPEED == CPU_24MHZ_CLKP2_24MHZ
                                         1657   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0611118   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1658   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0C22224   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1659   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0311118   ; C
                                                   LKS1=CLKS2=24MHZ, CLK_VCO=192MHZ
                                         1660   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0622224   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1661   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0322224   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1662   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0322224   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1663   X  #elif CLOCK_SPEED == CPU_32MHZ_CLKP2_16MHZ
                                         1664   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0811216   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1665   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1022422   ; C
                                                   LKS1=CLKS2=64MHZ, CLK_VCO=128MHZ
                                         1666   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0411216   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1667   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0822422   ; C
                                                   LKS1=CLKS2=64MHZ, CLK_VCO=128MHZ
                                         1668   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0211216   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1669   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0422422   ; C
                                                   LKS1=CLKS2=64MHZ, CLK_VCO=128MHZ
                                         1670   X  #elif CLOCK_SPEED == CPU_32MHZ_CLKP1_16MHZ_CLKP2
                                                   _16MHZ
                                         1671   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0812216   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1672   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1024422   ; C
                                                   LKS1=CLKS2=64MHZ, CLK_VCO=128MHZ
                                         1673   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0412216   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1674   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0824422   ; C
                                                   LKS1=CLKS2=64MHZ, CLK_VCO=128MHZ
                                         1675   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0212216   ; C
                                                   LKS1=CLKS2=32MHZ, CLK_VCO=192MHZ
                                         1676   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0424422   ; C
                                                   LKS1=CLKS2=64MHZ, CLK_VCO=128MHZ
                                         1677   X  #elif CLOCK_SPEED == CPU_40MHZ_CLKP2_16MHZ
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  50
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1678   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x1422522   ; C
                                                   LKS1=CLKS2=80MHZ, CLK_VCO=160MHZ
                                         1679   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1422522   ; C
                                                   LKS1=CLKS2=80MHZ, CLK_VCO=160MHZ
                                         1680   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0A22522   ; C
                                                   LKS1=CLKS2=80MHZ, CLK_VCO=160MHZ
                                         1681   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0A22522   ; C
                                                   LKS1=CLKS2=80MHZ, CLK_VCO=160MHZ
                                         1682   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0522522   ; C
                                                   LKS1=CLKS2=80MHZ, CLK_VCO=160MHZ
                                         1683   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0522522   ; C
                                                   LKS1=CLKS2=80MHZ, CLK_VCO=160MHZ
                                         1684   X  #elif CLOCK_SPEED == CPU_48MHZ_CLKP2_16MHZ
                                         1685   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0C11314   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1686   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1822622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1687   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0611314   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1688   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0C22622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1689   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0311314   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1690   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0622622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1691   X  #elif CLOCK_SPEED == CPU_48MHZ_CLKP1_32MHZ_CLKP2
                                                   _16MHZ
                                         1692   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x1823622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1693   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1823622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1694   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0C23622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1695   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0C23622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1696   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0623622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1697   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0623622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1698   X  #elif CLOCK_SPEED == CPU_48MHZ_CLKP1_16MHZ_CLKP2
                                                   _16MHZ
                                         1699   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0C13314   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1700   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x1826622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1701   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0613314   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1702   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0C26622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1703   X  #  set  CLK_PARAMS_16MHZ_PLL_LOW 0x0313314   ; C
                                                   LKS1=CLKS2=48MHZ, CLK_VCO=192MHZ
                                         1704   X  #  set  CLK_PARAMS_16MHZ_CLKB2   0x0626622   ; C
                                                   LKS1=CLKS2=96MHZ, CLK_VCO=192MHZ
                                         1705   X  #elif CLOCK_SPEED == CPU_56MHZ_CLKP2_14MHZ
                                         1706   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0E11412   ; C
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  51
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1707   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0E11412   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1708   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0711412   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1709   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0711412   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1710   X  #  if CRYSTAL == FREQ_16MHZ
                                         1711   X  #    error Current combination of "CRYSTAL" and
                                                   "CLOCK_SETTING" is not supported.
                                         1712   X  #  endif
                                         1713   X  #elif CLOCK_SPEED == CPU_56MHZ_CLKP2_8MHZ
                                         1714   X  #  set   CLK_PARAMS_4MHZ_PLL_LOW 0x0E11712   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1715   X  #  set   CLK_PARAMS_4MHZ_CLKB2   0x0E11712   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1716   X  #  set   CLK_PARAMS_8MHZ_PLL_LOW 0x0711712   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1717   X  #  set   CLK_PARAMS_8MHZ_CLKB2   0x0711712   ; C
                                                   LKS1=CLKS2=56MHZ, CLK_VCO=112MHZ
                                         1718   X  #  if CRYSTAL == FREQ_16MHZ
                                         1719   X  #    error Current combination of "CRYSTAL" and
                                                   "CLOCK_SETTING" is not supported.
                                         1720   X  #  endif
                                         1721   X  #else
                                         1722   X  #  error The selected setting of "CLOCK_SPEED" i
                                                   s not supported.
                                         1723      #endif
                                         1724
                                         1725      #if CRYSTAL == FREQ_4MHZ
                                         1726   X  #  set CLK_PARAMS_PLL_LOW    CLK_PARAMS_4MHZ_PLL
                                                   _LOW
                                         1727   X  #  set CLK_PARAMS_CLKB2      CLK_PARAMS_4MHZ_CLK
                                                   B2
                                         1728      #elif CRYSTAL == FREQ_8MHZ
                                         1729      #  set CLK_PARAMS_PLL_LOW    CLK_PARAMS_8MHZ_PLL
                                                   _LOW
                                         1730      #  set CLK_PARAMS_CLKB2      CLK_PARAMS_8MHZ_CLK
                                                   B2
                                         1731      #elif CRYSTAL == FREQ_16MHZ
                                         1732   X  #  set CLK_PARAMS_PLL_LOW    CLK_PARAMS_16MHZ_PL
                                                   L_LOW
                                         1733   X  #  set CLK_PARAMS_CLKB2      CLK_PARAMS_16MHZ_CL
                                                   KB2
                                         1734   X  #else
                                         1735   X  #  error specified crystal frequency ("CRYSTAL")
                                                    is not supported by this file.
                                         1736      #endif
                                         1737
                                         1738      #if   CLOCK_OPTIMIZATION == LOW_PLL_OPTIMIZATION
                                         1739   X  #  set CLK_PARAMS    CLK_PARAMS_PLL_LOW
                                         1740      #elif CLOCK_OPTIMIZATION == WAIT_STATE_OPTIMIZAT
                                                   ION
                                         1741      #  set CLK_PARAMS    CLK_PARAMS_CLKB2
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  52
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1742      #else
                                         1743   X  #  error "CLOCK_OPTIMIZATION" contains an invali
                                                   d setting.
                                         1744      #endif
                                         1745
                                         1746      #set      FREQ_1MHZ       D'1000000L
                                         1747
                                         1748      ;===============================================
                                                   =====================
                                         1749      ; macros to evaluate parameter settings
                                         1750
                                         1751      #define PLL_MULTIPLIER(params) \
                                         1752        ((params & 0xFF00000L) >> 20)
                                         1753
                                         1754      #define CLKB_DIVIDER(params) \
                                         1755        ((params & 0x00F0000L) >> 16)
                                         1756
                                         1757      #define CLKP1_DIVIDER(params) \
                                         1758        ((params & 0x000F000L) >> 12)
                                         1759
                                         1760      #define CLKP2_DIVIDER(params) \
                                         1761        ((params & 0x0000F00L) >>  8)
                                         1762
                                         1763      #define CLKP3_DIVIDER(params) \
                                         1764        ((params & 0x00000F0L) >>  4)
                                         1765
                                         1766      #define VCO_MULTIPLIER(params) \
                                         1767        ((params & 0x000000FL) >>  0)
                                         1768
                                         1769      #define  CLKVCO(params)\
                                         1770        (CRYSTAL * PLL_MULTIPLIER(params) * VCO_MULTIP
                                                   LIER(params))
                                         1771
                                         1772      #define CLKS1_CLKS2(params) \
                                         1773        (CRYSTAL * PLL_MULTIPLIER(params))
                                         1774
                                         1775      #define CLKB(params) \
                                         1776        (CLKS1_CLKS2(params) / CLKB_DIVIDER(params))
                                         1777
                                         1778      #define CLKP1(params) \
                                         1779        (CLKS1_CLKS2(params) / CLKP1_DIVIDER(params))
                                         1780
                                         1781      #if (CLKP2_CLKP3_SOURCE == CLOCK_PLL)
                                         1782      #  define CLKP2(params) \
                                         1783           (CLKS1_CLKS2(params) / CLKP2_DIVIDER(params
                                                   ))
                                         1784      #elif (CLKP2_CLKP3_SOURCE == CLOCK_MAIN)
                                         1785   X  #  define CLKP2(params) \
                                         1786   X       (CRYSTAL / CLKP2_DIVIDER(params))
                                         1787   X  #else
                                         1788   X  #  error Clock source for CLKP2 is not supported
                                                   .
                                         1789      #endif
                                         1790
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  53
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1791      #if (CLKP2_CLKP3_SOURCE == CLOCK_PLL)
                                         1792      #  define CLKP3(params) \
                                         1793           (CLKS1_CLKS2(params) / CLKP3_DIVIDER(params
                                                   ))
                                         1794      #elif (CLKP2_CLKP3_SOURCE == CLOCK_MAIN)
                                         1795   X  #  define CLKP3(params) \
                                         1796   X       (CRYSTAL / CLKP3_DIVIDER(params))
                                         1797   X  #else
                                         1798   X  #  error Clock source for CLKP2 is not supported
                                                   .
                                         1799      #endif
                                         1800
                                         1801      ;===============================================
                                                   =====================
                                         1802      ; debug code
                                         1803
                                         1804      #if 0
                                         1805   X  #  set CPLL CLKS1_CLKS2(CLK_PARAMS)
                                         1806   X  #  set CVCO CLKVCO(CLK_PARAMS)
                                         1807   X  #  set CB   CLKB(CLK_PARAMS)
                                         1808   X  #  set CP1  CLKP1(CLK_PARAMS)
                                         1809   X  #  set CP2  CLKP2(CLK_PARAMS)
                                         1810   X  #  set CP3  CLKP3(CLK_PARAMS)
                                         1811   X  #  error "CLKPLL" CPLL, "CLKVCO" CVCO, "CLKB" CB
                                                   , "CLKP1" CP1, "CLKP2" CP2, "CLKP3" CP3
                                         1812      #endif
                                         1813
                                         1814      ;===============================================
                                                   =====================
                                         1815      ; protect all devices from common illegal settin
                                                   gs
                                         1816
                                         1817
                                         1818      #if (CLKS1_CLKS2(CLK_PARAMS) > (96 * FREQ_1MHZ))
                                         1819   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1820      #endif
                                         1821      #if (CLKP1(CLK_PARAMS) > (56 * FREQ_1MHZ))
                                         1822   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1823      #endif
                                         1824      #if (CLKP2(CLK_PARAMS) > (32 * FREQ_1MHZ))
                                         1825   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1826      #endif
                                         1827
                                         1828      #if (CLKVCO(CLK_PARAMS) < (50 * FREQ_1MHZ))
                                         1829   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1830      #endif
                                         1831      #if (CLKVCO(CLK_PARAMS) > (200 * FREQ_1MHZ))
                                         1832   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1833      #endif
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  54
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1834      #if (VCO_MULTIPLIER(CLK_PARAMS) & 1)
                                         1835   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1836      #endif
                                         1837      #if (!(VCO_MULTIPLIER(CLK_PARAMS) & 0xFE))
                                         1838   X  #  error The current clock setting ("CLOCK_SPEED
                                                   ") is not allowed for the selected device.
                                         1839      #endif
                                         1840
                                         1841      ; protect certain devices from specific illegal
                                                   settings
                                         1842
                                         1843      #if (SERIES == MB96330)
                                         1844   X  #  if (CLKP1(CLK_PARAMS) > (48 * FREQ_1MHZ))
                                         1845   X  #    error The current clock setting ("CLOCK_SPE
                                                   ED") is not allowed for the selected device.
                                         1846   X  #  endif
                                         1847   X  #  if (CLKP3(CLK_PARAMS) > (48 * FREQ_1MHZ))
                                         1848   X  #    error The current clock setting ("CLOCK_SPE
                                                   ED") is not allowed for the selected device.
                                         1849   X  #  endif
                                         1850      #endif ; (SERIES == MB96330)
                                         1851
                                         1852      #if (SERIES == MB96340)
                                         1853      #  if (
                                                                                  \
                                         1854              (DEVICE == MB96348HxA) ||
                                                                                  \
                                         1855              (DEVICE == MB96348TxA) ||
                                                                                  \
                                         1856              (DEVICE == MB96348CxA)
                                                                                  \
                                         1857            )
                                         1858   X  #    if (CLKS1_CLKS2(CLK_PARAMS) > (56 * FREQ_1M
                                                   HZ))
                                         1859   X  #      error The current clock setting ("CLOCK_S
                                                   PEED" and "CLOCK_OPTIMIZATION") is not allowed f
                                                   or the selected device.
                                         1860   X  #    endif
                                         1861   X  #    if (CLKP2(CLK_PARAMS) > (14 * FREQ_1MHZ))
                                         1862   X  #      error The current clock setting ("CLOCK_S
                                                   PEED") is not allowed for the selected device.
                                         1863   X  #    endif
                                         1864      #  elif (
                                                                                  \
                                         1865              (DEVICE == MB96346RxA) ||
                                                                                  \
                                         1866              (DEVICE == MB96346YxA) ||
                                                                                  \
                                         1867              (DEVICE == MB96346AxA) ||
                                                                                  \
                                         1868              (DEVICE == MB96347RxA) ||
                                                                                  \
                                         1869              (DEVICE == MB96347YxA) ||
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  55
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                                                  \
                                         1870              (DEVICE == MB96347AxA) ||
                                                                                  \
                                         1871              (DEVICE == MB96348RxA) ||
                                                                                  \
                                         1872              (DEVICE == MB96348YxA) ||
                                                                                  \
                                         1873              (DEVICE == MB96348AxA) ||
                                                                                  \
                                         1874              (DEVICE == MB96346RxB) ||
                                                                                  \
                                         1875              (DEVICE == MB96346YxB) ||
                                                                                  \
                                         1876              (DEVICE == MB96346AxB) ||
                                                                                  \
                                         1877              (DEVICE == MB96347RxB) ||
                                                                                  \
                                         1878              (DEVICE == MB96347YxB) ||
                                                                                  \
                                         1879              (DEVICE == MB96347AxB) ||
                                                                                  \
                                         1880              (DEVICE == MB96348RxB) ||
                                                                                  \
                                         1881              (DEVICE == MB96348YxB) ||
                                                                                  \
                                         1882              (DEVICE == MB96348AxB)
                                                                                  \
                                         1883            )
                                         1884      #    if (CLKS1_CLKS2(CLK_PARAMS) > (74 * FREQ_1M
                                                   HZ))
                                         1885   X  #      error The current clock setting ("CLOCK_S
                                                   PEED" and "CLOCK_OPTIMIZATION") is not allowed f
                                                   or the selected device.
                                         1886      #    endif
                                         1887      #    if (CLKP2(CLK_PARAMS) > (28 * FREQ_1MHZ))
                                         1888   X  #      error The current clock setting ("CLOCK_S
                                                   PEED") is not allowed for the selected device.
                                         1889      #    endif
                                         1890      #  else
                                         1891   X  #    if (CLKP2(CLK_PARAMS) > (28 * FREQ_1MHZ))
                                         1892   X  #      error The current clock setting ("CLOCK_S
                                                   PEED") is not allowed for the selected device.
                                         1893   X  #    endif
                                         1894      #  endif
                                         1895      #endif ; (SERIES == MB96340)
                                         1896
                                         1897      #if (SERIES == MB96370)
                                         1898   X  #  if (CLKS1_CLKS2(CLK_PARAMS) > (80 * FREQ_1MHZ
                                                   ))
                                         1899   X  #    error The current clock setting ("CLOCK_SPE
                                                   ED" and "CLOCK_OPTIMIZATION") is not allowed for
                                                    the selected device.
                                         1900   X  #  endif
                                         1901   X  #  if (CLKP1(CLK_PARAMS) > (40 * FREQ_1MHZ))
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  56
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1902   X  #    error The current clock setting ("CLOCK_SPE
                                                   ED") is not allowed for the selected device.
                                         1903   X  #  endif
                                         1904      #endif ; (SERIES == MB96370)
                                         1905
                                         1906      #if (SERIES == MB96380)
                                         1907   X  #  if (
                                                                                  \
                                         1908   X          (DEVICE == MB96385RxA) ||
                                                                                  \
                                         1909   X          (DEVICE == MB96385YxA) ||
                                                                                  \
                                         1910   X          (DEVICE == MB96388HxB) ||
                                                                                  \
                                         1911   X          (DEVICE == MB96389RxB)
                                                                                  \
                                         1912   X        )
                                         1913   X  #    if (CLKS1_CLKS2(CLK_PARAMS) > (80 * FREQ_1M
                                                   HZ))
                                         1914   X  #      error The current clock setting ("CLOCK_S
                                                   PEED" and "CLOCK_OPTIMIZATION") is not allowed f
                                                   or the selected device.
                                         1915   X  #    endif
                                         1916   X  #    if (CLKP1(CLK_PARAMS) > (40 * FREQ_1MHZ))
                                         1917   X  #      error The current clock setting ("CLOCK_S
                                                   PEED") is not allowed for the selected device.
                                         1918   X  #    endif
                                         1919   X  #  elif (
                                                                                  \
                                         1920   X          (DEVICE == MB96386RxA) ||
                                                                                  \
                                         1921   X          (DEVICE == MB96386YxA) ||
                                                                                  \
                                         1922   X          (DEVICE == MB96387RxA) ||
                                                                                  \
                                         1923   X          (DEVICE == MB96387YxA) ||
                                                                                  \
                                         1924   X          (DEVICE == MB96386RxB) ||
                                                                                  \
                                         1925   X          (DEVICE == MB96386YxB) ||
                                                                                  \
                                         1926   X          (DEVICE == MB96387RxB) ||
                                                                                  \
                                         1927   X          (DEVICE == MB96387YxB)
                                                                                  \
                                         1928   X        )
                                         1929   X  #    if (CLKS1_CLKS2(CLK_PARAMS) > (74 * FREQ_1M
                                                   HZ))
                                         1930   X  #      error The current clock setting ("CLOCK_S
                                                   PEED" and "CLOCK_OPTIMIZATION") is not allowed f
                                                   or the selected device.
                                         1931   X  #    endif
                                         1932   X  #    if (CLKP2(CLK_PARAMS) > (28 * FREQ_1MHZ))
                                         1933   X  #      error The current clock setting ("CLOCK_S
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  57
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   PEED") is not allowed for the selected device.
                                         1934   X  #    endif
                                         1935   X  #  elif (
                                                                                  \
                                         1936   X          (DEVICE == MB96384RxA) ||
                                                                                  \
                                         1937   X          (DEVICE == MB96384YxA)
                                                                                  \
                                         1938   X        )
                                         1939   X      ; nothing - basic check from above is suffic
                                                   ient
                                         1940   X  #  else
                                         1941   X  #    error The selected device is not supported
                                                   in this version.
                                         1942   X  #  endif
                                         1943      #endif ; (SERIES == MB96380)
                                         1944
                                         1945      #if (SERIES == MB96390)
                                         1946   X  #  if (
                                                                                  \
                                         1947   X          (DEVICE == MB96395RxA)
                                                                                  \
                                         1948   X        )
                                         1949   X  #    if (CLKS1_CLKS2(CLK_PARAMS) > (80 * FREQ_1M
                                                   HZ))
                                         1950   X  #      error The current clock setting ("CLOCK_S
                                                   PEED" and "CLOCK_OPTIMIZATION") is not allowed f
                                                   or the selected device.
                                         1951   X  #    endif
                                         1952   X  #    if (CLKP1(CLK_PARAMS) > (40 * FREQ_1MHZ))
                                         1953   X  #      error The current clock setting ("CLOCK_S
                                                   PEED") is not allowed for the selected device.
                                         1954   X  #    endif
                                         1955   X  #  endif
                                         1956      #endif ; (SERIES == MB96390)
                                         1957
                                         1958
                                         1959      ;===============================================
                                                   =====================
                                         1960      ; define register settings
                                         1961
                                         1962      #if SERIES == MB96330
                                         1963   X  ;  CLKP3 divider shall be set only if CLKP3 is a
                                                   vailable on the device.
                                         1964   X  #  define PLLCR_SETTING(params)
                                                                                  \
                                         1965   X       (
                                                                                  \
                                         1966   X        ((CLKP3_DIVIDER(params)  - 1) << 8)
                                                                                  \
                                         1967   X        |
                                                                                  \
                                         1968   X        ((VCO_MULTIPLIER(params) - 2) << 4)
                                                                                  \
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  58
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         1969   X        |
                                                                                  \
                                         1970   X        ((PLL_MULTIPLIER(params) - 1) << 0)
                                                                                  \
                                         1971   X       )
                                         1972      #else
                                         1973      ;  CLKP3 divider shall be set to B'000 if CLKP3
                                                   is not available on the device.
                                         1974      #  define PLLCR_SETTING(params)
                                                                                  \
                                         1975           (
                                                                                  \
                                         1976            ((VCO_MULTIPLIER(params) - 2) << 4)
                                                                                  \
                                         1977            |
                                                                                  \
                                         1978            ((PLL_MULTIPLIER(params) - 1) << 0)
                                                                                  \
                                         1979           )
                                         1980      #endif
                                         1981
                                         1982      #define CKFCR_SETTING(params)
                                                                                  \
                                         1983        (
                                                                                  \
                                         1984          ((CLKP2_DIVIDER(params) - 1) << 12)
                                                                                  \
                                         1985          |
                                                                                  \
                                         1986          ((CLKP1_DIVIDER(params) - 1) <<  8)
                                                                                  \
                                         1987          |
                                                                                  \
                                         1988          ((CLKB_DIVIDER(params)  - 1) <<  4)
                                                                                  \
                                         1989          |
                                                                                  \
                                         1990          1
                                                                                  \
                                         1991        )
                                         1992
                                         1993      #define CKSR_SETTING(CLKS1_SOURCE, CLKS2_SOURCE)
                                                                                  \
                                         1994        (
                                                                                  \
                                         1995          0xF0
                                                                                  \
                                         1996          |
                                                                                  \
                                         1997          ((CLKS2_SOURCE & 0x3)
                                                                        << 2)     \
                                         1998          |
                                                                                  \
                                         1999          ((CLKS1_SOURCE & 0x3)
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  59
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                                        << 0)     \
                                         2000        )
                                         2001
                                         2002      ;===============================================
                                                   =====================
                                         2003      ; define flash timings
                                         2004
                                         2005      #set MTCR_DEFAULT         0x0239
                                         2006
                                         2007      #if   (CLKS1_CLKS2(CLK_PARAMS) <= ( 25 * FREQ_1M
                                                   HZ)) && (CLKB(CLK_PARAMS) <= ( 25 * FREQ_1MHZ))
                                         2008      #  set MTCR_INITIAL       0x0239
                                         2009      #elif (CLKS1_CLKS2(CLK_PARAMS) <= ( 32 * FREQ_1M
                                                   HZ)) && (CLKB(CLK_PARAMS) <= ( 32 * FREQ_1MHZ))
                                         2010   X  #  set MTCR_INITIAL       0x2129
                                         2011   X  #elif (CLKS1_CLKS2(CLK_PARAMS) <= ( 56 * FREQ_1M
                                                   HZ)) && (CLKB(CLK_PARAMS) <= ( 56 * FREQ_1MHZ))
                                         2012   X  #  set MTCR_INITIAL       0x233A
                                         2013   X  #else
                                         2014   X  #  set MTCR_INITIAL       0x6E3D
                                         2015      #endif
                                         2016
                                         2017      #if (CLKB_DIVIDER(CLK_PARAMS) == 2)
                                         2018      #  if   (CLKS1_CLKS2(CLK_PARAMS) <= ( 32 * FREQ_
                                                   1MHZ)) && (CLKB(CLK_PARAMS) <= ( 16 * FREQ_1MHZ)
                                                   )
                                         2019      #    set MTCR_STABILIZED  0x2128
                                         2020      #  elif (((( 20 * FREQ_1MHZ) <= CLKS1_CLKS2(CLK_
                                                   PARAMS)) && (CLKS1_CLKS2(CLK_PARAMS) <= ( 50 * F
                                                   REQ_1MHZ)) )\
                                         2021           &&  ((( 10 * FREQ_1MHZ) <= CLKB(CLK_PARAMS)
                                                   )        && (CLKB(CLK_PARAMS)        <= ( 28 * F
                                                   REQ_1MHZ))))
                                         2022   X  #    set MTCR_STABILIZED  0x2208
                                         2023   X  #  elif (CLKS1_CLKS2(CLK_PARAMS) <= ( 84 * FREQ_
                                                   1MHZ)) && (CLKB(CLK_PARAMS) <= ( 42 * FREQ_1MHZ)
                                                   )
                                         2024   X  #    set MTCR_STABILIZED  0x4C09
                                         2025   X  #  elif (((( 20 * FREQ_1MHZ) <= CLKS1_CLKS2(CLK_
                                                   PARAMS)) && (CLKS1_CLKS2(CLK_PARAMS) <= (100 * F
                                                   REQ_1MHZ)) )\
                                         2026   X       &&  ((( 10 * FREQ_1MHZ) <= CLKB(CLK_PARAMS)
                                                   )        && (CLKB(CLK_PARAMS)        <= ( 50 * F
                                                   REQ_1MHZ))))
                                         2027   X  #    set MTCR_STABILIZED  0x6B09
                                         2028   X  #  else
                                         2029   X  #    set MTCR_STABILIZED  MTCR_INITIAL
                                         2030      #  endif
                                         2031      #elif (CLKB_DIVIDER(CLK_PARAMS) > 2)
                                         2032   X  #  if   (CLKS1_CLKS2(CLK_PARAMS) <= ( 32 * FREQ_
                                                   1MHZ)) && (CLKB(CLK_PARAMS) <= ( 16 * FREQ_1MHZ)
                                                   )
                                         2033   X  #    set MTCR_STABILIZED  0x2128
                                         2034   X  #  else
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  60
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         2035   X  #    set MTCR_STABILIZED  MTCR_INITIAL
                                         2036   X  #  endif
                                         2037   X  #else ; if (CLKB_DIVIDER(CLK_PARAMS) >= 2)
                                         2038   X  #  set   MTCR_STABILIZED  MTCR_INITIAL
                                         2039      #endif ; else (CLKB_DIVIDER(CLK_PARAMS) == 2)
                                         2040
                                         2041      ;===============================================
                                                   =====================
                                         2042      ; PLL startup sequence
                                         2043
CO 000010 73DF0604A100                   2044                MOVW PLLCR, # PLLCR_SETTING(CLK_PARAMS
                                                   )
CO 000016 73DF04041111                   2045                MOVW CKFCR, # CKFCR_SETTING(CLK_PARAMS
                                                   )
CO 00001C 71DF2C04F6                     2046                MOV  VRCR,  #0xF6         ; 1,9V core
                                                   voltage
                                         2047      #if MTCR_INITIAL != MTCR_DEFAULT
                                         2048   X            MOV  MCSRA, #0x70         ; 1,9V flash
                                                    voltage
                                         2049   X            MOVW MTCRA, # MTCR_INITIAL
                                         2050   X  #  if FLASH_B_AVAILABLE == ON
                                         2051   X            MOV  MCSRB, #0x70         ; 1,9V flash
                                                    voltage
                                         2052   X            MOVW MTCRB, # MTCR_INITIAL
                                         2053   X  #  endif ; FLASH_B_AVAILABLE == ON
                                         2054      #endif
CO 000021 71DF0104FA                     2055                MOV  CKSR,  # CKSR_SETTING(CLKB_CLKP1_
                                                   SOURCE, CLKP2_CLKP3_SOURCE)
                                         2056
                                         2057      ;===============================================
                                                   =====================
                                         2058      ; 6.6   Set external bus configuaration
                                         2059      ;===============================================
                                                   =====================
                                         2060
                                         2061      #if BUSMODE != SINGLE_CHIP         ; ext bus use
                                                   d
                                         2062   X
                                         2063   X  ; check if non-multiplexed mode is available for
                                                    device
                                         2064   X  #  if (ADDRESSMODE == NON_MULTIPLEXED) && \
                                         2065   X     (                                      \
                                         2066   X      (SERIES == MB96320)                   \
                                         2067   X      ||                                    \
                                         2068   X      (SERIES == MB96340)                   \
                                         2069   X      ||                                    \
                                         2070   X      (SERIES == MB96350)                   \
                                         2071   X     )
                                         2072   X  #    error Non-multiplexed external bus is not a
                                                   vailable for the selected device.
                                         2073   X  #  endif
                                         2074   X
                                         2075   X             MOV  EBCF, #((HOLD_REQ << 7) | (EXT_R
                                                   EADY << 6) | (EXT_CLOCK_ENABLE << 5) | (EXT_CLOC
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  61
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   K_INVERT << 4) | (EXT_CLOCK_SUSPEND << 3) | EXT_
                                                   CLOCK_DIVISION)
                                         2076   X             MOV  EBAE0,#ADDR_PINS_7_0
                                         2077   X             MOV  EBAE1,#ADDR_PINS_15_8
                                         2078   X             MOV  EBAE2,#ADDR_PINS_23_16
                                         2079   X             MOV  EBCS, #((ADDRESS_STROBE_LVL << 6
                                                   ) | (ADDRESS_STROBE << 5) | (READ_STROBE << 4) |
                                                    (HIGH_WRITE_STROBE << 3) | (LOW_WRITE_STROBE <<
                                                    2) | (HIGH_BYTE_SIGNAL << 1) | LOW_BYTE_SIGNAL)
                                         2080   X             MOV  EAS2, #CS2_START
                                         2081   X             MOV  EAS3, #CS3_START
                                         2082   X             MOV  EAS4, #CS4_START
                                         2083   X             MOV  EAS5, #CS5_START
                                         2084   X             MOVW EACL0,#CS0_CONFIG
                                         2085   X             MOVW EACL1,#CS1_CONFIG
                                         2086   X             MOVW EACL2,#CS2_CONFIG
                                         2087   X             MOVW EACL3,#CS3_CONFIG
                                         2088   X             MOVW EACL4,#CS4_CONFIG
                                         2089   X             MOVW EACL5,#CS5_CONFIG
                                         2090   X             MOV  EBM,  #((ADDRESSMODE << 7) | ((B
                                                   USMODE-1) << 6) | (CHIP_SELECT5 << 5) | (CHIP_SE
                                                   LECT4 << 4) | (CHIP_SELECT3 << 3) | (CHIP_SELECT
                                                   2 << 2) | (CHIP_SELECT1 << 1) | CHIP_SELECT0) ;
                                                   set address mode, ROM access
                                         2091   X
                                         2092   X  #  if (SERIES == MB96320) || (SERIES == MB96330)
                                                    || (SERIES == MB96340) || (SERIES == MB96350)
                                         2093   X             MOV  PIER00,#0xFF
                                         2094   X  #    if (CS0_CONFIG & 0x0080) == 0 || (CS1_CONFI
                                                   G & 0x0080) == 0 || (CS2_CONFIG & 0x0080) == 0 |
                                                   | (CS3_CONFIG & 0x0080) == 0 || (CS4_CONFIG & 0x
                                                   0080) == 0 || (CS5_CONFIG & 0x0080) == 0
                                         2095   X             MOV  PIER01,#0xFF
                                         2096   X  #    endif
                                         2097   X  #    if HOLD_REQ == ON
                                         2098   X             SETB PIER03:4
                                         2099   X  #    endif
                                         2100   X  #    if EXT_READY == ON
                                         2101   X             SETB PIER03:6
                                         2102   X  #    endif
                                         2103   X
                                         2104   X  #  elif (SERIES == MB96370) || (SERIES == MB9638
                                                   0)
                                         2105   X             MOV  PIER01,#0xFF
                                         2106   X  #    if (CS0_CONFIG & 0x0080) == 0 || (CS1_CONFI
                                                   G & 0x0080) == 0 || (CS2_CONFIG & 0x0080) == 0 |
                                                   | (CS3_CONFIG & 0x0080) == 0 || (CS4_CONFIG & 0x
                                                   0080) == 0 || (CS5_CONFIG & 0x0080) == 0
                                         2107   X             MOV  PIER02,#0xFF
                                         2108   X  #    endif
                                         2109   X  #    if HOLD_REQ == ON
                                         2110   X             SETB PIER12:7
                                         2111   X  #    endif
                                         2112   X  #    if EXT_READY == ON
                                         2113   X             SETB PIER00:2
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  62
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         2114   X  #    endif
                                         2115   X  #  elif (SERIES == MB96310) || (SERIES == MB9639
                                                   0) || (SERIES == MB96910)
                                         2116   X  #    error External bus is not available for the
                                                    selected device.
                                         2117   X  #  endif
                                         2118   X
                                         2119      #endif
                                         2120
                                         2121      #if BUSMODE == INTROM_EXTBUS     ; EXTBUS and IN
                                                   TROM/EXTROM
                                         2122   X  #  if ROMMIRROR == OFF && CONSTDATA == ROMCONST
                                         2123   X  #    error Mirror function must be ON to mirror
                                                   internal ROM
                                         2124   X  #  endif
                                         2125      #endif
                                         2126
          = 000000F7                     2127      ROMM_CONFIG    .EQU     ((MIRROR_BANK << 4) | (M
                                                   IRROR_SIZE << 1) | (ROMMIRROR))
CO 000026 71DFAE03F7                     2128                 MOV  ROMM, #ROMM_CONFIG
                                         2129
                                         2130
                                         2131      ;===============================================
                                                   =====================
                                         2132      ; 6.7   Prepare stacks and set the default stack
                                                    type
                                         2133      ;===============================================
                                                   =====================
                                         2134      ;
                                         2135      ; Note:
                                         2136      ; After reset the system stack is set to the end
                                                    of internal RAM
                                         2137      ; (default location). This stack can already be
                                                   used by a monitor debugger
                                         2138      ; that uses BootROM support (e.g. EUROScope, but
                                                    not emulator).
                                         2139      ; To prevent overwriting of initialized global v
                                                   ariables by stack contents,
                                         2140      ; the stack has to be relocated to its final des
                                                   tination before
                                         2141      ; initialization of global variables.
                                         2142
                                         2143      ; Use word aligned stack section. Stack symbols
                                                   are ignored.
                                         2144      #define SSTACK_L    ((SSTACK + 1) & ~1)
                                         2145      #define SSTACK_H    ((SSTACK + SIZEOF(SSTACK)) &
                                                    ~1)
                                         2146      #define SSTACK_BNK  BNKSEC SSTACK
                                         2147
                                         2148      #define USTACK_L    ((USTACK + 1) & ~1)
                                         2149      #define USTACK_H    ((USTACK + SIZEOF(USTACK)) &
                                                    ~1)
                                         2150      #define USTACK_BNK  BNKSEC USTACK
                                         2151
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  63
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

CO 00002B 24DF                           2152                AND  CCR,#H'DF            ; clear syst
                                                   em stack flag
CO 00002D 4B00000000                S    2153                MOVL A, #USTACK_H
CO 000032 47                             2154                MOVW SP,A                 ; load offse
                                                   t of stack top to pointer
CO 000033 4200                      S    2155                MOV  A, #USTACK_BNK       ; load bank
                                                   of stack start address to A
CO 000035 6F13                           2156                MOV  USB, A               ; set bank
                                         2157
                                         2158      #if STACK_FILL == ON                ; preset the
                                                    stack
CO 000037 4B00000000                S    2159                MOVL A, #(USTACK_L)       ; load start
                                                    stack address to A
CO 00003C 4AAA55                         2160                MOVW A, #STACK_PATTERN    ; AL -> AH,
                                                   pattern in AL
CO 00003F A80000                    S    2161                MOVW RW0, #(USTACK_H - USTACK_L) / 2 ;
                                                    get word count
CO 000042 6EE3                           2162                FILSWI    SPB             ; write patt
                                                   ern to stack
                                         2163      #endif
                                         2164
CO 000044 2520                           2165                OR   CCR,#H'20            ; set System
                                                    stack flag
CO 000046 4B00000000                S    2166                MOVL A, #SSTACK_H
CO 00004B 47                             2167                MOVW SP,A                 ; load offse
                                                   t of stack top to pointer
                                         2168      ;!!!!!!!!!!!!!!!!!!!!!!!!!!!!ATTENTION!!!!!!!!!!
                                                   !!!!!!!!!!!!!!!!!!!!!
                                         2169      ; When monitor debugger that uses BootROM suppor
                                                   t (e.g. EUROScope,
                                         2170      ; but not emulator) is used and system stack is
                                                   located outside
                                         2171      ; bank 0 (e.g. on external RAM) no break shall b
                                                   e issued on the
                                         2172      ; following two instructions. I.e The following
                                                   two lines shall
                                         2173      ; neither be stepped on by debugger step operati
                                                   on, nor shall a
                                         2174      ; break point be set on that line.
                                         2175      ; Setting a break point to the instruction after
                                                    the next two
                                         2176      ; lines is always safe.
CO 00004C 4200                      S    2177                MOV  A, #SSTACK_BNK       ; load bank
                                                   of stack start address to A
CO 00004E 6F12                           2178                MOV  SSB, A               ; set bank
                                         2179      ;!!!!!!!!!!!!!!!!!!!!!!!!!!!!ATTENTION!!!!!!!!!!
                                                   !!!!!!!!!!!!!!!!!!!!!
                                         2180
                                         2181      #if STACK_FILL == ON                ; preset the
                                                    stack
CO 000050 4B00000000                S    2182                MOVL A, #(SSTACK_L)       ; load start
                                                    stack address to A
CO 000055 4AAA55                         2183                MOVW A, #STACK_PATTERN    ; AL -> AH,
                                                   pattern in AL
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  64
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

CO 000058 A80000                    S    2184                MOVW RW0, #(SSTACK_H - SSTACK_L) / 2;
                                                   get byte count
CO 00005B 6EE3                           2185                FILSWI    SPB             ; write patt
                                                   ern to stack
                                         2186      #endif
                                         2187
                                         2188      #if STACKUSE == USRSTACK
                                         2189   X            AND  CCR,#H'DF            ; clear syst
                                                   em stack flag
                                         2190      #endif
                                         2191
                                         2192
                                         2193      ;   The following macro is needed because of the
                                                    AUTOMODEL option. If the
                                         2194      ;   model is not known while assembling the modu
                                                   le, one has to expect
                                         2195      ;   completion of streaminit() by RET or RETP. B
                                                   ecause RET removes 2 bytes
                                         2196      ;   from stack and RETP removes 4 bytes from sta
                                                   ck, SP is reloaded.
                                         2197
                                         2198      #macro RELOAD_SP
                                         2199
                                         2200      #  if STACKUSE == USRSTACK
                                         2201                MOVW A, #USTACK_H
                                         2202      #  else
                                         2203                MOVW A, #SSTACK_H
                                         2204      #  endif
                                         2205                MOVW SP,A
                                         2206      #endm
                                         2207
                                         2208      ;===============================================
                                                   =====================
                                         2209      ; 6.8   Copy initial values to data areas.
                                         2210      ;===============================================
                                                   =====================
                                         2211      ;
                                         2212      ; Each C-module has its own __far INIT section.
                                                   The names are generic.
                                         2213      ; DCONST_module contains the initializers for th
                                                   e far data of the one
                                         2214      ; module. INIT_module reserves the RAM area, whi
                                                   ch has to be loaded
                                         2215      ; with the data from DCONST_module. ("module" is
                                                    the name of the *.c
                                         2216      ; file)
                                         2217      ; All separated DCONST_module/INIT_module areas
                                                   are described in
                                         2218      ; DTRANS section by start addresses and length o
                                                   f each far section.
                                         2219      ;   0000 1. source address (ROM)
                                         2220      ;   0004 1. destination address (RAM)
                                         2221      ;   0008 length of sections 1
                                         2222      ;   000A 2. source address  (ROM)
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  65
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         2223      ;   000E 2. destination address (RAM)
                                         2224      ;   0012 length of sections 2
                                         2225      ;   0014 3. source address ...
                                         2226      ; In addition the start-up file adds the descrip
                                                   tors of the __near
                                         2227      ; sections to this table. The order of the descr
                                                   iptors in this table
                                         2228      ; depends on the linkage order.
                                         2229      ;
                                         2230      ; Note: Sections cannot exceed bank boundaries.
                                         2231      ;===============================================
                                                   =====================
CO 00005D 4B00000000                S    2232                MOVL A, #DTRANS          ; get address
                                                    of table
CO 000062 71A4                           2233                MOVL RL2, A              ; store addre
                                                   ss in RL2 (RW4/RW5)
CO 000064 6019                           2234                BRA  LABEL2              ; branch to l
                                                   oop condition
CO 000066                                2235      LABEL1:
CO 000066 6F4C06                         2236                MOVW A, @RL2+6           ; get bank of
                                                    destination
CO 000069 6F10                           2237                MOV  DTB, A              ; save dest b
                                                   ank in DTB
CO 00006B 6F4C02                         2238                MOVW A, @RL2+2           ; get source
                                                   bank
CO 00006E 6F11                           2239                MOV  ADB, A              ; save source
                                                    bank in ADB
CO 000070 6F4C08                         2240                MOVW A, @RL2+8           ; number of b
                                                   ytes to copy -> A
CO 000073 98                             2241                MOVW RW0, A              ; number of b
                                                   ytes to copy -> RW0
CO 000074 6F4C04                         2242                MOVW A, @RL2+4           ; move destin
                                                   ation addr in AL
CO 000077 6F4C00                         2243                MOVW A, @RL2             ; AL -> AH, s
                                                   rc addr -> AL
CO 00007A 6E06                           2244                MOVSI DTB, ADB           ; copy data
CO 00007C DA                             2245                MOVN A, #10              ; length of o
                                                   ne table entry is 10
CO 00007D 7704                           2246                ADDW RW4, A              ; set pointer
                                                    to next table entry
CO 00007F                                2247      LABEL2:
CO 00007F 8C                             2248                MOVW A, RW4              ; get address
                                                    of next block
CO 000080 3B0000                    S    2249                CMPW A, #DTRANS + SIZEOF (DTRANS) ; al
                                                   l blocks processed ?
CO 000083 F1E1                           2250                BNE  LABEL1              ; if not, bra
                                                   nch
                                         2251
                                         2252      ;===============================================
                                                   =====================
                                         2253      ; 6.9   Clear uninitialized data areas to zero
                                         2254      ;===============================================
                                                   =====================
                                         2255      ;
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  66
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         2256      ; Each C-module has its own __far DATA section.
                                                   The names are generic.
                                         2257      ; DATA_module contains the reserved area (RAM) t
                                                   o be cleared.
                                         2258      ; ("module" is the name of the *.c file)
                                         2259      ; All separated DATA_module areas are described
                                                   in DCLEAR section by
                                         2260      ; start addresses and length of all far section.
                                         2261      ;   0000 1. section address (RAM)
                                         2262      ;   0004 length of section 1
                                         2263      ;   0006 2. section address (RAM)
                                         2264      ;   000A length of section 2
                                         2265      ;   000C 3. section address (RAM)
                                         2266      ;   0010 length of section 3 ...
                                         2267      ; In addition the start-up file adds the descrip
                                                   tors of the __near
                                         2268      ; sections to this table. The order of the descr
                                                   iptors in this table
                                         2269      ; depends on the linkage order.
                                         2270      ;===============================================
                                                   =====================
CO 000085 4200                      S    2271                MOV  A, #BNKSEC DCLEAR   ; get bank of
                                                    table
CO 000087 6F10                           2272                MOV  DTB, A              ; store bank
                                                   in DTB
CO 000089 A90000                    S    2273                MOVW RW1, #DCLEAR        ; get start o
                                                   ffset of table
CO 00008C 6010                           2274                BRA  LABEL4              ; branch to l
                                                   oop condition
CO 00008E                                2275      LABEL3:
CO 00008E 729102                         2276                MOV  A, @RW1+2           ; get section
                                                    bank
CO 000091 6F11                           2277                MOV  ADB, A              ; save sectio
                                                   n bank in ADB
CO 000093 7B1104                         2278                MOVW RW0, @RW1+4         ; number of b
                                                   ytes to copy -> RW0
CO 000096 7389                           2279                MOVW A, @RW1             ; move sectio
                                                   n addr in AL
CO 000098 D0                             2280                MOVN A, #0               ; AL -> AH, i
                                                   nit value -> AL
CO 000099 6EC2                           2281                FILSI     ADB            ; write 0 to
                                                   section
CO 00009B D6                             2282                MOVN A, #6               ; length of o
                                                   ne table entry is 6
CO 00009C 7701                           2283                ADDW RW1, A              ; set pointer
                                                    to next table entry
CO 00009E                                2284      LABEL4:
CO 00009E 89                             2285                MOVW A, RW1              ; get address
                                                    of next block
CO 00009F 390000                    S    2286                SUBW A, #DCLEAR          ; sub address
                                                    of first block
CO 0000A2 3B0000                    S    2287                CMPW A, #SIZEOF (DCLEAR) ; all blocks
                                                   processed ?
CO 0000A5 F1E7                           2288                BNE  LABEL3              ; if not, bra
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  67
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                                   nch
                                         2289
                                         2290
                                         2291
                                         2292      ;===============================================
                                                   =====================
                                         2293      ; 6.10  Set Data Bank Register (DTB) and Direct
                                                   Page Register (DPR)
                                         2294      ;===============================================
                                                   =====================
CO 0000A7 4200                      S    2295                MOV  A,#BNKSEC DATA          ; User da
                                                   ta bank offset
CO 0000A9 6F10                           2296                MOV  DTB,A
                                         2297
CO 0000AB 4200                      R    2298                MOV  A,#PAGE DIRDATA_S       ; User di
                                                   rect page
CO 0000AD 6F14                           2299                MOV  DPR,A
                                         2300
                                         2301      ;===============================================
                                                   =====================
                                         2302      ; 6.11  ICU register initialization workaround
                                         2303      ;===============================================
                                                   =====================
                                         2304
                                         2305      #if (UART_SCANNING == ON)
                                         2306   X  #  if (((SERIES == MB96320) && (DEVICE < 3)) ||
                                                   \
                                         2307   X         ((SERIES == MB96350) && (DEVICE < 3)))
                                         2308   X            MOVN A, #0
                                         2309   X            MOV  TCCSL2, A
                                         2310   X            MOV  TCCSL3, A
                                         2311   X            MOV  ICE67, A
                                         2312   X            MOV  ICE89, A
                                         2313   X            MOV  ICE1011, A
                                         2314   X            MOV  ICS89, A
                                         2315   X            MOV  ICS1011, A
                                         2316   X  #  endif ; ((SERIES == 96350) && ...
                                         2317   X  #  if (((SERIES == MB96330) && (DEVICE < 2))  ||
                                                    \
                                         2318   X         ((SERIES == MB96340) && (DEVICE < 27)) ||
                                                    \
                                         2319   X         ((SERIES == MB96370) && (DEVICE < 3))  ||
                                                    \
                                         2320   X         ((SERIES == MB96380) && (DEVICE < 13)))
                                         2321   X            MOVN A, #0
                                         2322   X            MOV  ICE01, A
                                         2323   X            MOV  ICE67, A
                                         2324   X  #  endif ; (((SERIES == MB96330) && (DEVICE < 2)
                                                   ) || ...
                                         2325      #endif ; (UART_SCANNING == ON)
                                         2326
                                         2327      ;===============================================
                                                   =====================
                                         2328      ; 6.12  Wait for clocks to stabilize
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  68
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         2329      ;===============================================
                                                   =====================
                                         2330
                                         2331      #if CLOCKWAIT == ON
                                         2332      #  if CLKB_CLKP1_SOURCE == CLOCK_MAIN
                                         2333   X  no_MC_yet:
                                         2334   X            BBC  CKMR:5,no_MC_yet        ; check M
                                                   CM and wait for
                                         2335   X                                         ; Main Cl
                                                   ock to stabilize
                                         2336      #  elif CLKB_CLKP1_SOURCE == CLOCK_PLL
CO 0000AF                                2337      no_PLL_yet:
CO 0000AF 6C9E0304FB                     2338                BBC  CKMR:6,no_PLL_yet       ; check P
                                                   CM and wait for
                                         2339                                             ; PLL to
                                                   stabilize
                                         2340      #    if MTCR_STABILIZED != MTCR_INITIAL
CO 0000B4 73DFF2032821                   2341                MOVW MTCRA, # MTCR_STABILIZED
                                         2342      #      if FLASH_B_AVAILABLE == ON
                                         2343   X            MOVW MTCRB, # MTCR_STABILIZED
                                         2344      #      endif ; if FLASH_B_AVAILABLE == ON
                                         2345      #    endif ; if MTCR_STABILIZED != MTCR_INITIAL
                                         2346      #  else
                                         2347   X  #    error Setting of CLKB_CLKP1_SOURCE is not s
                                                   upported.
                                         2348      #  endif
                                         2349      #endif
                                         2350
                                         2351      ;===============================================
                                                   =====================
                                         2352      ; 6.13  Initialise Low-Level Library Interface
                                         2353      ;===============================================
                                                   =====================
                                         2354      ;
                                         2355      ; Call lib init function and reload stack afterw
                                                   ards, if AUTOMODEL
                                         2356      ;===============================================
                                                   =====================
                                         2357      #if CLIBINIT == ON
                                         2358   X  #  if MEMMODEL == SMALL || MEMMODEL == COMPACT
                                         2359   X            CALL __stream_init       ; initialise
                                                   library IO
                                         2360   X  #  else                            ; MEDIUM, LAR
                                                   GE, AUTOMODEL
                                         2361   X            CALLP __stream_init      ; initialise
                                                   library IO
                                         2362   X  #    if MEMMODEL == AUTOMODEL
                                         2363   X            RELOAD_SP                ; reload stac
                                                   k since stream_init was
                                         2364   X                                     ; possibly le
                                                   ft by RET (not RETP)
                                         2365   X  #    endif  ; AUTOMODEL
                                         2366   X  #  endif  ; MEDIUM, LARGE, AUTOMODEL
                                         2367      #endif  ; LIBINI
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  69
STARTUP FILE FOR MEMORY INITIALISATION

SN LOC    OBJ                           LLINE      SOURCE

                                         2368
                                         2369      ;===============================================
                                                   =====================
                                         2370      ; 6.14  Call C-language main function
                                         2371      ;===============================================
                                                   =====================
                                         2372      #if MEMMODEL == SMALL || MEMMODEL == COMPACT
                                         2373   X            CALL _main               ; Start main
                                                   function
                                         2374      #else                              ; MEDIUM, LAR
                                                   GE, AUTOMODEL
CO 0000BA 65000000                  I    2375                CALLP _main              ; Start main
                                                   function
                                         2376                                         ; ignore rema
                                                   ining word on stack,
                                         2377                                         ; if main was
                                                    completed by RET
                                         2378      #endif
                                         2379      ;===============================================
                                                   =====================
                                         2380      ; 6.15  Shut down library
                                         2381      ;===============================================
                                                   =====================
                                         2382      #if CLIBINIT == ON
                                         2383   X  #  if MEMMODEL == SMALL || MEMMODEL == COMPACT
                                         2384   X            CALL _exit
                                         2385   X  #  else                            ; MEDIUM, LAR
                                                   GE, AUTOMODEL
                                         2386   X            CALLP _exit              ; ignore rema
                                                   ining word on stack,
                                         2387   X                                     ; if main was
                                                    completed by RET
                                         2388   X  #  endif
                                         2389   X  __exit:
                                         2390      #endif
                                         2391
                                         2392      ;===============================================
                                                   =====================
                                         2393      ; 6.16  Program end loop
                                         2394      ;===============================================
                                                   =====================
                                         2395
CO 0000BE 60FE                           2396      end:      BRA  end                 ; Loop
                                         2397
          =>  00000001              R    2398                .END notresetyet         ; define debu
                                                   gger start address
_____________________________________________________________________________
F2MC-16 Family SOFTUNE Assembler V30L13       2012-05-17 16:24:24   Page:  70
- SECTION LISTING - ( STARTUP )

   NO SECTION-NAME                       SIZE  ATTRIBUTES

    0 RESVECT  . . . . . . . . . . . .  000004 CONST   ABS LOCATE=FFFFDC
    1 BOOT_SELECT  . . . . . . . . . .  000004 CONST   ABS LOCATE=DF0030
    2 UART_SCAN_SELECT . . . . . . . .  00000C CONST   ABS LOCATE=DF0034
    3 DATA . . . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
    4 DATA2  . . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
    5 DIRDATA  . . . . . . . . . . . .  000000 DIR     REL ALIGN=2
    6 LIBDATA  . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
    7 INIT . . . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
    8 INIT2  . . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
    9 DIRINIT  . . . . . . . . . . . .  000000 DIR     REL ALIGN=2
   10 LIBINIT  . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
   11 CINIT  . . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
   12 CINIT2 . . . . . . . . . . . . .  000000 DATA    REL ALIGN=2
   13 DCONST . . . . . . . . . . . . .  000000 CONST   REL ALIGN=2
   14 DIRCONST . . . . . . . . . . . .  000000 DIR CNS REL ALIGN=2
   15 LIBDCONST  . . . . . . . . . . .  000000 CONST   REL ALIGN=2
   16 CONST  . . . . . . . . . . . . .  000000 CONST   REL ALIGN=2
   17 CONST2 . . . . . . . . . . . . .  000000 CONST   REL ALIGN=2
   18 DCLEAR . . . . . . . . . . . . .  000012 CONST   REL ALIGN=2
   19 DTRANS . . . . . . . . . . . . .  000032 CONST   REL ALIGN=2
   20 SSTACK . . . . . . . . . . . . .  000300 STACK   REL ALIGN=2
   21 USTACK . . . . . . . . . . . . .  000002 STACK   REL ALIGN=2
   22 FLASH_A_SECURITY . . . . . . . .  00001C CONST   ABS LOCATE=DF0000
   23 FLASH_A_PROTECT  . . . . . . . .  000014 CONST   ABS LOCATE=DF001C
   24 BDM_CONFIG . . . . . . . . . . .  000040 CONST   ABS LOCATE=DF0040
   25 CODE_START . . . . . . . . . . .  0000C0 CODE    REL ALIGN=1
